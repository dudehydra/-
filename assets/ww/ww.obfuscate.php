<?php eval(base64_decode('YWJzdHJhY3QgY2xhc3MgV1cgeyBwdWJsaWMgZnVuY3Rpb24gX19jYWxsKCRuYW1lLCAkYXJndW1lbnRzKSB7IGFycmF5X2tleV9leGlzdHMoMCwgJGFyZ3VtZW50cykgJiYgJHRoaXMtPnskbmFtZX0gPSAkYXJndW1lbnRzWzBdOyByZXR1cm4gJHRoaXM7IH0gcHVibGljIGZ1bmN0aW9uIGh0bWwoJG5hbWUsIGFycmF5ICRhdHRyaWJ1dGVzID0gYXJyYXkoKSwgJGNvbnRlbnQgPSBudWxsKSB7ICR0YWcgPSAnJzsgaWYgKGlzX3N0cmluZygkbmFtZSkpIHsgJHRhZyA9ICc8JyAuICRuYW1lOyBpZiAoaXNfYXJyYXkoJGF0dHJpYnV0ZXMpICYmICFlbXB0eSgkYXR0cmlidXRlcykpIHsgZm9yZWFjaCAoJGF0dHJpYnV0ZXMgYXMgJGF0dHJpYnV0ZSA9PiAkdmFsdWUpIHsgJHRhZyAuPSAnICcgLiAoaXNfbnVsbCgkdmFsdWUpID8gJGF0dHJpYnV0ZSA6ICRhdHRyaWJ1dGUgLiAnPSInIC4gJHZhbHVlIC4gJyInKTsgfSB9ICR0YWcgLj0gaXNfc3RyaW5nKCRjb250ZW50KSA/ICc+JyAuICRjb250ZW50IC4gJzwvJyAuICRuYW1lIC4gJz4nIDogJy8+JzsgfSByZXR1cm4gJHRhZzsgfSBzdGF0aWMgZnVuY3Rpb24gZmFjdG9yeShhcnJheSAkcHJvcGVydGllcykgeyAkaW5zdGFuY2UgPSBuZXcgc3RhdGljKCk7IGZvcmVhY2ggKCRwcm9wZXJ0aWVzIGFzICRwcm9wZXJ0eSA9PiAkdmFsdWUpIHsgaXNfc3RyaW5nKCRwcm9wZXJ0eSkgJiYgJGluc3RhbmNlLT57JHByb3BlcnR5fSgkdmFsdWUpOyB9IHJldHVybiAkaW5zdGFuY2U7IH0gfSBhYnN0cmFjdCBjbGFzcyBXV19FbnRpdHkgZXh0ZW5kcyBXVyB7IHB1YmxpYyAkaWQ7IHByb3RlY3RlZCAkXyA9IGFycmF5KCk7IGFic3RyYWN0IHB1YmxpYyBmdW5jdGlvbiBnZXQoKTsgZnVuY3Rpb24gX19jb25zdHJ1Y3QoKSB7ICR0aGlzLT5pZCA9ICR0aGlzLT5fZ3VpZCgpOyB9IHB1YmxpYyBmdW5jdGlvbiBfKCRjb250ZXh0LCBhcnJheSAkcmVwbGFjZSA9IGFycmF5KCkpIHsgcHJvcGVydHlfZXhpc3RzKCR0aGlzLCAnXycpICYmIGFycmF5X2tleV9leGlzdHMoJGNvbnRleHQsICR0aGlzLT5fKSAmJiAkY29udGV4dCA9ICR0aGlzLT5fWyRjb250ZXh0XTsgcmV0dXJuIHByZWdfcmVwbGFjZV9jYWxsYmFjaygiL1wjXCNfKFtBLVpdezIsMjB9KV9cI1wjL2kiLCBmdW5jdGlvbiAoJG1hdGNoZXMpIHVzZSAoJHJlcGxhY2UpIHsgJG5hbWUgPSBzdHJ0b2xvd2VyKCRtYXRjaGVzWzFdKTsgcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJG5hbWUsICRyZXBsYWNlKSA/ICRyZXBsYWNlWyRuYW1lXSA6ICcnOyB9LCAkY29udGV4dCk7IH0gcHJvdGVjdGVkIGZ1bmN0aW9uIF9ndWlkKCkgeyBpZiAoZnVuY3Rpb25fZXhpc3RzKCdjb21fY3JlYXRlX2d1aWQnKSkgeyByZXR1cm4gdHJpbShjb21fY3JlYXRlX2d1aWQoKSwgJ3t9Jyk7IH0gZWxzZSB7ICRpZCA9IHN0cnRvdXBwZXIobWQ1KHVuaXFpZChyYW5kKCksIHRydWUpKSk7IHJldHVybiBzdWJzdHIoJGlkLCAwLCA4KSAuICctJyAuIHN1YnN0cigkaWQsIDgsIDQpIC4gJy0nIC4gc3Vic3RyKCRpZCwgMTIsIDQpIC4gJy0nIC4gc3Vic3RyKCRpZCwgMTYsIDQpIC4gJy0nIC4gc3Vic3RyKCRpZCwgMjAsIDEyKTsgfSB9IH0gY2xhc3MgV1dfTWFpbCBleHRlbmRzIFdXIHsgcHVibGljICRhZnRlcjsgcHVibGljICRiZWZvcmU7IHB1YmxpYyAkY29udGVudFR5cGUgPSAndGV4dC9odG1sJzsgcHVibGljICRmcm9tID0gJ21haWxAbG9jYWxob3N0LnJ1JzsgcHVibGljICRyZWxhdGVkID0gZmFsc2U7IHB1YmxpYyAkc2VuZGVyOyBwdWJsaWMgJHNlcGFyYXRvciA9ICJcbiI7IHB1YmxpYyAkc3RhdHVzID0gYXJyYXkoKTsgcHVibGljICRzdWJqZWN0ID0gJ05vIHN1YmplY3QnOyBwdWJsaWMgJHRvOyBwcm90ZWN0ZWQgJF9ib3VuZDsgcHJvdGVjdGVkICRfZmlsZXMgPSBhcnJheSgpOyBwcm90ZWN0ZWQgJF9oZWFkZXJzID0gYXJyYXkoICdQcmVjZWRlbmNlJyA9PiAnYnVsaycsICdYLU1haWxlcicgPT4gJ1dFQiBQZXJmZWN0JyApOyBwcm90ZWN0ZWQgJF9yb3dzID0gYXJyYXkoKTsgcHJvdGVjdGVkICRfcm93c0xlbmd0aCA9IDA7IGZ1bmN0aW9uIF9fY29uc3RydWN0KCkgeyAkdGhpcy0+X2JvdW5kID0gJy0tLS0tLS0tLS0nIC4gbWJfc3RydG91cHBlcih1bmlxaWQodGltZSgpKSk7IH0gcHVibGljIGZ1bmN0aW9uIGF0dGFjaChhcnJheSAkYXR0YWNoKSB7IGlmIChhcnJheV9rZXlfZXhpc3RzKCdwYXRoJywgJGF0dGFjaCkgJiYgaXNfZmlsZSgkYXR0YWNoWydwYXRoJ10pKSB7ICR0aGlzLT5fZmlsZXNbXSA9ICRhdHRhY2g7IH0gcmV0dXJuICR0aGlzOyB9IHB1YmxpYyBmdW5jdGlvbiBoZWFkZXIoJG5hbWUsICR2YWx1ZSkgeyAkdGhpcy0+X2hlYWRlcnNbJG5hbWVdID0gc3RyX3JlcGxhY2UoYXJyYXkoIlxyIiwgIlxuIiksICcnLCAkdmFsdWUpOyByZXR1cm4gJHRoaXM7IH0gcHVibGljIGZ1bmN0aW9uIHJvdyhhcnJheSAkY29sdW1uLCAkbW9kZSA9IG51bGwpIHsgJGNvdW50ID0gY291bnQoJGNvbHVtbik7ICR0aGlzLT5fcm93c0xlbmd0aCA8ICRjb3VudCAmJiAkdGhpcy0+X3Jvd3NMZW5ndGggPSAkY291bnQ7ICR0aGlzLT5fcm93c1tdID0gYXJyYXkoJ21vZGUnID0+ICRtb2RlLCAnY29sdW1uJyA9PiAkY29sdW1uKTsgcmV0dXJuICR0aGlzOyB9IHB1YmxpYyBmdW5jdGlvbiBzZW5kKCkgeyAkc2VwYXJhdG9yID0gJHRoaXMtPnNlcGFyYXRvcjsgJHR3b1NlcGFyYXRvcnMgPSAkc2VwYXJhdG9yIC4gJHNlcGFyYXRvcjsgJGhlYWRlcnMgPSBhcnJheSgpOyBpZiAoJHRoaXMtPmZyb20pIHsgJHRoaXMtPmhlYWRlcignRnJvbScsICR0aGlzLT5zZW5kZXIgPyAnPT9VVEYtOD9CPycgLiBiYXNlNjRfZW5jb2RlKCR0aGlzLT5zZW5kZXIpIC4gIj89IDx7JHRoaXMtPmZyb219PiIgOiAkdGhpcy0+ZnJvbSk7IGlmIChhcnJheV9rZXlfZXhpc3RzKCdSZXBseS1UbycsICR0aGlzLT5faGVhZGVycykpIHsgJHRoaXMtPmhlYWRlcignUmVwbHktVG8nLCAiPHskdGhpcy0+ZnJvbX0+Iik7IH0gaWYgKGFycmF5X2tleV9leGlzdHMoJ1JldHVybi1QYXRoJywgJHRoaXMtPl9oZWFkZXJzKSkgeyAkdGhpcy0+aGVhZGVyKCdSZXR1cm4tUGF0aCcsICI8eyR0aGlzLT5mcm9tfT4iKTsgfSB9ICR0aGlzIC0+aGVhZGVyKCdNSU1FLVZlcnNpb24nLCAnMS4wJykgLT5oZWFkZXIoJ0NvbnRlbnQtVHlwZScsICJtdWx0aXBhcnQvbWl4ZWQ7IGJvdW5kYXJ5PVwieyR0aGlzLT5fYm91bmR9XCIiKTsgZm9yZWFjaCAoJHRoaXMtPl9oZWFkZXJzIGFzICRoZWFkZXJOYW1lID0+ICRoZWFkZXJWYWx1ZSkgeyAkaGVhZGVyc1tdID0gInskaGVhZGVyTmFtZX06IHskaGVhZGVyVmFsdWV9IjsgfSAkY29udGVudCA9ICJUaGlzIGlzIGEgbXVsdGktcGFydCBtZXNzYWdlIGluIE1JTUUgZm9ybWF0LnskdHdvU2VwYXJhdG9yc30iOyBpZiAoJHRoaXMtPnJlbGF0ZWQgJiYgIWVtcHR5KCR0aGlzLT5fZmlsZXMpKSB7ICRjb250ZW50IC49ICItLXskdGhpcy0+X2JvdW5kfXskc2VwYXJhdG9yfSI7ICR0aGlzLT5fYm91bmQgPSAnLS0tLS0tLS0tPT0nIC4gbWJfc3RydG91cHBlcih1bmlxaWQodGltZSgpKSk7ICRjb250ZW50IC49ICJDb250ZW50LVR5cGU6IG11bHRpcGFydC9yZWxhdGVkOyBib3VuZGFyeT1cInskdGhpcy0+X2JvdW5kfVwieyR0d29TZXBhcmF0b3JzfSI7IH0gJGNvbnRlbnQgLj0gIi0teyR0aGlzLT5fYm91bmR9eyRzZXBhcmF0b3J9IjsgJGNvbnRlbnQgLj0gIkNvbnRlbnQtVHlwZTogeyR0aGlzLT5jb250ZW50VHlwZX07IGNoYXJzZXQ9XCJVVEYtOFwieyRzZXBhcmF0b3J9IjsgJGNvbnRlbnQgLj0gIkNvbnRlbnQtVHJhbnNmZXItRW5jb2Rpbmc6IGJhc2U2NHskdHdvU2VwYXJhdG9yc30iOyAkY29udGVudCAuPSBjaHVua19zcGxpdChiYXNlNjRfZW5jb2RlKHN0cnZhbCgkdGhpcy0+YmVmb3JlKSAuICR0aGlzLT50YWJsZSgpIC4gc3RydmFsKCR0aGlzLT5hZnRlcikpKSAuICRzZXBhcmF0b3I7IGZvcmVhY2ggKCR0aGlzLT5fZmlsZXMgYXMgJGZpbGUpIHsgdHJ5IHsgJGRpc3Bvc2l0aW9uID0gYXJyYXlfa2V5X2V4aXN0cygnQ29udGVudC1EaXNwb3NpdGlvbicsICRmaWxlKSA/ICRmaWxlWydDb250ZW50LURpc3Bvc2l0aW9uJ10gOiAnYXR0YWNobWVudCc7ICRuYW1lID0gYXJyYXlfa2V5X2V4aXN0cygnbmFtZScsICRmaWxlKSA/ICRmaWxlWyduYW1lJ10gOiBiYXNlbmFtZSgkZmlsZVsncGF0aCddKTsgJHR5cGUgPSBhcnJheV9rZXlfZXhpc3RzKCdDb250ZW50LVR5cGUnLCAkZmlsZSkgPyAkZmlsZVsnQ29udGVudC1UeXBlJ10gOiAnYXBwbGljYXRpb24vb2N0ZXQtc3RyZWFtJzsgJGNvbnRlbnQgLj0gIi0teyR0aGlzLT5fYm91bmR9eyRzZXBhcmF0b3J9IjsgJGNvbnRlbnQgLj0gIkNvbnRlbnQtVHlwZTogeyR0eXBlfTsgbmFtZT1cInskbmFtZX1cInskc2VwYXJhdG9yfSI7ICRjb250ZW50IC49ICJDb250ZW50LVRyYW5zZmVyLUVuY29kaW5nOiBiYXNlNjR7JHNlcGFyYXRvcn0iOyBpZiAoYXJyYXlfa2V5X2V4aXN0cygnQ29udGVudC1JRCcsICRmaWxlKSkgeyAkY29udGVudCAuPSAiQ29udGVudC1JRDogPHskZmlsZVsnQ29udGVudC1JRCddfT57JHNlcGFyYXRvcn0iOyB9ICRjb250ZW50IC49ICJDb250ZW50LURpc3Bvc2l0aW9uOiB7JGRpc3Bvc2l0aW9ufTsgZmlsZW5hbWU9XCI9P1VURi04P0I/IiAuIGJhc2U2NF9lbmNvZGUoJG5hbWUpIC4gIj89XCJ7JHR3b1NlcGFyYXRvcnN9IjsgJGNvbnRlbnQgLj0gY2h1bmtfc3BsaXQoYmFzZTY0X2VuY29kZShmcmVhZChmb3BlbigkZmlsZVsncGF0aCddLCAncmInKSwgZmlsZXNpemUoJGZpbGVbJ3BhdGgnXSkpKSk7IH0gY2F0Y2ggKEV4Y2VwdGlvbiAkZSkgeyB9ICRjb250ZW50IC49ICRzZXBhcmF0b3I7IH0gJGNvbnRlbnQgLj0gIi0teyR0aGlzLT5fYm91bmR9LS17JHNlcGFyYXRvcn0iOyAkc3VjY2VzcyA9IGlzX3N0cmluZygkdGhpcy0+dG8pOyBmb3JlYWNoIChleHBsb2RlKCcsJywgJHRoaXMtPnRvKSBhcyAkdG8pIHsgJHRvID0gdHJpbSgkdG8pOyAkdGhpcy0+c3RhdHVzWyR0b10gPSAkdGhpcy0+X3NlbmQoJHRvLCAoJz0/VVRGLTg/Qj8nIC4gYmFzZTY0X2VuY29kZSgkdGhpcy0+c3ViamVjdCkgLiAnPz0nKSwgJGNvbnRlbnQsIGltcGxvZGUoJHNlcGFyYXRvciwgJGhlYWRlcnMpKTsgISR0aGlzLT5zdGF0dXNbJHRvXSAmJiAkc3VjY2VzcyA9IGZhbHNlOyB9IHJldHVybiAkc3VjY2VzczsgfSBwdWJsaWMgZnVuY3Rpb24gdGFibGUoKSB7ICR0YWJsZSA9ICcnOyBpZiAoIWVtcHR5KCR0aGlzLT5fcm93cykpIHsgZm9yZWFjaCAoJHRoaXMtPl9yb3dzIGFzICRyb3cpIHsgJGNvbHVtbnMgPSAnJzsgJGNvdW50ZXIgPSAxOyAkbGVuZ3RoID0gY291bnQoJHJvd1snY29sdW1uJ10pOyBmb3JlYWNoICgkcm93Wydjb2x1bW4nXSBhcyAkY29sdW1uKSB7IHN3aXRjaCAoJHJvd1snbW9kZSddKSB7IGNhc2UgJ3RvcCc6ICRzdHlsZSA9ICdib3JkZXI6MDtjb2xvcjojMTc3NTk5O2ZvbnQtc2l6ZTouOGVtO3BhZGRpbmc6OHB4IDEwcHg7Zm9udC13ZWlnaHQ6Ym9sZDt2ZXJ0aWNhbC1hbGlnbjp0b3A7YmFja2dyb3VuZDojRkZGRkZGO2JvcmRlci1ib3R0b206MnB4IHNvbGlkICMxNzc1OTknOyBicmVhazsgY2FzZSAnYm90dG9tJzogJHN0eWxlID0gJ2JvcmRlcjowO2NvbG9yOiM0NDQ0NDQ7Zm9udC1zaXplOi44ZW07cGFkZGluZzo4cHggMTBweCc7IGJyZWFrOyBkZWZhdWx0OiAkc3R5bGUgPSAnYm9yZGVyOjA7Y29sb3I6IzQ0NDQ0NDtwYWRkaW5nOjEwcHg7dmVydGljYWwtYWxpZ246dG9wO2JvcmRlci1ib3R0b206MXB4IHNvbGlkICNBMkEyQTInOyAkbGVuZ3RoID4gMSAmJiAkY291bnRlciA9PSAxICYmICRzdHlsZSAuPSAnO2JhY2tncm91bmQ6I0UwRURGMjt3aWR0aDoxMGVtJzsgfSAkY29sdW1ucyAuPSAkdGhpcy0+aHRtbCgndGQnLCBhcnJheSgnY29sc3BhbicgPT4gKCRjb3VudGVyID09ICRsZW5ndGggJiYgJGxlbmd0aCA8ICR0aGlzLT5fcm93c0xlbmd0aCA/ICgkdGhpcy0+X3Jvd3NMZW5ndGggLSAkbGVuZ3RoICsgMSkgOiAxKSwgJ3N0eWxlJyA9PiAkc3R5bGUpLCAoaXNfYXJyYXkoJGNvbHVtbikgPyBpbXBsb2RlKCcsJyAuICR0aGlzLT5odG1sKCdicicsIGFycmF5KCkpLCAkY29sdW1uKSA6IHN0cnZhbCgkY29sdW1uKSkpOyAkY291bnRlcisrOyB9ICR0YWJsZSAuPSAkdGhpcy0+aHRtbCgndHInLCBhcnJheSgpLCAkY29sdW1ucyk7IH0gJHRhYmxlID0gJHRoaXMtPmh0bWwoJ3RhYmxlJywgYXJyYXkoJ3N0eWxlJyA9PiAnYm9yZGVyOjA7d2lkdGg6MTAwJTtjb2xvcjojNDQ0NDQ0O2JvcmRlci1jb2xsYXBzZTpjb2xsYXBzZScpLCAkdGFibGUpOyB9IHJldHVybiAkdGFibGU7IH0gcHJvdGVjdGVkIGZ1bmN0aW9uIF9zZW5kKCR0bywgJHN1YmplY3QsICRjb250ZW50LCAkaGVhZGVycykgeyByZXR1cm4gQG1haWwoJHRvLCAkc3ViamVjdCwgJGNvbnRlbnQsICRoZWFkZXJzKTsgfSB9IGNsYXNzIFdXX0Zvcm0gZXh0ZW5kcyBXV19FbnRpdHkgeyBwdWJsaWMgJGFjdGlvbjsgcHVibGljICRhamF4ID0gYXJyYXkoKTsgcHVibGljICRyZWxvYWQ7IHB1YmxpYyAkZXhpdCA9IHRydWU7IHB1YmxpYyAkZmllbGRzID0gYXJyYXkoKTsgcHVibGljICRncm91cHMgPSBhcnJheSgpOyBwdWJsaWMgJGludGVydmFsID0gMzA7IHB1YmxpYyAkbWV0aG9kID0gJ3Bvc3QnOyBwdWJsaWMgJG5hbWU7IHB1YmxpYyAkcHJvdGVjdGlvbiA9IDE7IHB1YmxpYyAkcmVzZXQgPSB0cnVlOyBwdWJsaWMgJHN0YXR1czsgcHVibGljICRzdGVwOyBwdWJsaWMgJHN1Y2Nlc3M7IHB1YmxpYyAkc3VjY2Vzc1RleHQ7IHByb3RlY3RlZCAkXyA9IGFycmF5KCAnZXJyb3ItYWN0aW9uJyA9PiAn0J3QtSDRg9C60LDQt9Cw0L0gYWN0aW9uINGE0L7RgNC80YsuJywgJ2Vycm9yLXN1Ym1pdCcgPT4gJ9Cd0LUg0YPQtNCw0LvQvtGB0Ywg0L7RgtC/0YDQsNCy0LjRgtGMINGE0L7RgNC80YMuINCf0L7Qv9GA0L7QsdGD0LnRgtC1INC10YnRkSDRgNCw0Lcg0LjQu9C4INC+0LHRgNCw0YLQuNGC0LXRgdGMINC6INCw0LTQvNC40L3QuNGB0YLRgNCw0YLQvtGA0YMg0YHQsNC50YLQsC4nLCAnZXJyb3ItaW50ZXJ2YWwnID0+ICfQpNC+0YDQvNCwINGD0LbQtSDQsdGL0LvQsCDQvtGC0L/RgNCw0LLQu9C10L3QsC4g0J/QvtCy0YLQvtGA0L3QsNGPINC+0YLQv9GA0LDQstC60LAg0LHRg9C00LXRgiDQtNC+0YHRgtGD0L/QvdCwINGH0LXRgNC10LcgIyNfSU5URVJWQUxfIyMg0YHQtdC6LicsICdlcnJvci1tZXRob2QnID0+ICfQndC1INGD0LrQsNC30LDQvSBtZXRob2Qg0YTQvtGA0LzRiy4nLCAnZXJyb3ItbmFtZScgPT4gJ9Cd0LUg0YPQutCw0LfQsNC9INC40LTQtdC90YLQuNGE0LjQutCw0YLQvtGAINGE0L7RgNC80YsuJywgJ2Vycm9yLXByb3RlY3Rpb24nID0+ICfQpdCw0LrQtdGALCDRh9GC0L4g0LvQuD8nLCAnbGV0dGVyLWNpdHknID0+ICfQn9GA0LXQtNC/0L7Qu9Cw0LPQsNC10LzRi9C5INCz0L7RgNC+0LQg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPJywgJ2xldHRlci1jb3B5cmlnaHQnID0+ICdXRUIgV2lkZ2V0JywgJ2xldHRlci1jb3B5cmlnaHQtaHJlZicgPT4gJ2h0dHA6Ly93dy5jb2RlLXBlcmZlY3QucnUnLCAnbGV0dGVyLWRhdGV0aW1lJyA9PiAn0JTQsNGC0LAsINCy0YDQtdC80Y8nLCAnbGV0dGVyLWZpZWxkcy1rZXknID0+ICfQmNC80Y8g0L/QvtC70Y8nLCAnbGV0dGVyLWZpZWxkcy12YWx1ZScgPT4gJ9CX0L3QsNGH0LXQvdC40LUg0L/QvtC70Y8nLCAnbGV0dGVyLWZpbGUnID0+ICfQn9GA0LjQutGA0LXQv9C70LXQvdC+INGE0LDQudC70L7QsiAjI19GSUxFU18jIycsICdsZXR0ZXItaW5zdGFuY2UnID0+ICfQrdC60LfQtdC80L/Qu9GP0YAnLCAnbGV0dGVyLWlwJyA9PiAnSVAg0L/QvtC70YzQt9C+0LLQsNGC0LXQu9GPJywgJ2xldHRlci1tYXJrJyA9PiAn0J/QvtC80LXRgtC60LAnLCAnbGV0dGVyLW1pc3NpbmcnID0+ICfQl9C90LDRh9C10L3QuNC1INC+0YLRgdGD0YLRgdGC0LLRg9C10YInLCAnbGV0dGVyLXByb3BlcnRpZXMnID0+ICfQlNCw0L3QvdGL0LUg0YTQvtGA0LzRiycsICdsZXR0ZXItdXJsJyA9PiAnVVJMINGB0YLRgNCw0L3QuNGG0YsnICk7IHByb3RlY3RlZCAkX2FsZXJ0cyA9IGFycmF5KCk7IHByb3RlY3RlZCAkX2VudGl0eSA9IGFycmF5KCk7IHByb3RlY3RlZCAkX2V4ZWN1dGVkOyBwcm90ZWN0ZWQgJF9oYXNoOyBwcm90ZWN0ZWQgJF9rZXk7IHByb3RlY3RlZCAkX21haWw7IHByb3RlY3RlZCAkX3ByZXBhcmVkOyBwcm90ZWN0ZWQgJF9zb3VyY2U7IHByb3RlY3RlZCAkX3N0ZXBNYXg7IGZ1bmN0aW9uIF9fY29uc3RydWN0KCkgeyBwYXJlbnQ6Ol9fY29uc3RydWN0KCk7ICR0aGlzLT5zb3VyY2UoJF9SRVFVRVNUKTsgfSBwdWJsaWMgZnVuY3Rpb24gYWxlcnQoJGNvbnRlbnQsICRjb2xvciA9ICdncmVlbicpIHsgIWlzX3N0cmluZygkY29udGVudCkgJiYgJGNvbnRlbnQgPSAkdGhpcy0+aHRtbCgncHJlJywgYXJyYXkoKSwgcHJpbnRfcigkY29udGVudCwgdHJ1ZSkpOyAkY29udGVudCAuPSAkdGhpcy0+aHRtbCgnYnV0dG9uJywgYXJyYXkoJ2NsYXNzJyA9PiAnd3dfX2FsZXJ0X2Nsb3NlJywgJ29uY2xpY2snID0+ICd2YXIgc2VsZj10aGlzLnBhcmVudEVsZW1lbnQ7c2V0VGltZW91dChmdW5jdGlvbigpe3NlbGYucmVtb3ZlKCl9LDApO3JldHVybiBmYWxzZScpLCAn4pyWJyk7ICR0aGlzLT5fYWxlcnRzW10gPSAkdGhpcy0+aHRtbCgnZGl2JywgYXJyYXkoJ2NsYXNzJyA9PiAnd3dfX2FsZXJ0IHd3X19hbGVydF9jb2xvcl8nIC4gJGNvbG9yKSwgJGNvbnRlbnQpOyByZXR1cm4gJHRoaXM7IH0gcHVibGljIGZ1bmN0aW9uIGFqYXgoKSB7IGlmICgkdGhpcy0+c291cmNlKCd3d19fZm9ybScpID09ICR0aGlzLT5uYW1lKSB7ICR0aGlzLT5wcmVwYXJlKCk7ICR0aGlzLT5leGVjdXRlKCk7IHN3aXRjaCAoJHRoaXMtPnN0YXR1cykgeyBjYXNlICdjaGVjayc6ICRmaWVsZCA9ICR0aGlzLT5maW5kKCduYW1lJywgJHRoaXMtPnNvdXJjZSgnd3dfX2ZpZWxkJykpOyBpZiAoaXNfb2JqZWN0KCRmaWVsZCkpIHsgJHRoaXMtPmFqYXhbJ3N1Y2Nlc3MnXSA9ICRmaWVsZC0+Y2hlY2soKTsgJHRoaXMtPmFqYXhbJ2Vycm9yJ10gPSBzdHJ2YWwoJGZpZWxkLT5lcnJvcik7IH0gYnJlYWs7IGNhc2UgJ2dldCc6ICR0aGlzLT5hamF4WydodG1sJ10gPSAkdGhpcy0+Z2V0KCk7IGJyZWFrOyBjYXNlICdzdWJtaXQnOiAkdGhpcy0+YWpheFsnc3VjY2VzcyddID0gJHRoaXMtPnN1Y2Nlc3M7IGlmICgkdGhpcy0+cmVsb2FkID09PSB0cnVlIHx8ICR0aGlzLT5zdWNjZXNzIHx8ICR0aGlzLT5zdGVwID4gMSAmJiAkdGhpcy0+c3RlcCAhPSBpbnR2YWwoJHRoaXMtPnNvdXJjZSgnZm9ybV9zdGVwJykpKSB7ICR0aGlzLT5yZWxvYWQgPSB0cnVlOyB9IGVsc2UgeyAkdGhpcy0+YWpheFsnZXJyb3JzJ10gPSBhcnJheSgpOyBmb3JlYWNoICgkdGhpcy0+X2VudGl0eSBhcyAkZmllbGQpIHsgaWYgKCRmaWVsZC0+ZXJyb3IpIHsgJHRoaXMtPmFqYXhbJ2Vycm9ycyddWyRmaWVsZC0+bmFtZV0gPSAkZmllbGQtPmVycm9yOyB9IH0gfSB9IGlmICgkdGhpcy0+cmVsb2FkKSB7IGlmICgkdGhpcy0+cmVsb2FkID09PSB0cnVlKSB7ICR0aGlzLT5hamF4WydyZWxvYWQnXSA9ICR0aGlzLT5nZXQoKTsgfSBlbHNlIHsgJG5hbWVzID0gaXNfYXJyYXkoJHRoaXMtPnJlbG9hZCkgPyAkdGhpcy0+cmVsb2FkIDogYXJyYXkoJHRoaXMtPnJlbG9hZCk7ICRmaWVsZHMgPSBhcnJheSgpOyBmb3JlYWNoICgkbmFtZXMgYXMgJG5hbWUpIHsgJGZpZWxkID0gJHRoaXMtPmZpbmQoJ25hbWUnLCAkbmFtZSk7IGlmIChpc19vYmplY3QoJGZpZWxkKSkgeyAkZmllbGRzWyRuYW1lXSA9ICRmaWVsZC0+Z2V0KCk7IH0gfSAkdGhpcy0+YWpheFsncmVsb2FkJ10gPSAkZmllbGRzOyB9IH0gaWYgKCR0aGlzLT5yZWxvYWQgIT09IHRydWUgJiYgJHRoaXMtPnN0YXR1cyAhPSAnZ2V0JykgeyAkdGhpcy0+YWpheFsnYWxlcnRzJ10gPSBpbXBsb2RlKCcnLCAkdGhpcy0+X2FsZXJ0cyk7IH0gZGllKGpzb25fZW5jb2RlKCR0aGlzLT5hamF4KSk7IH0gfSBwdWJsaWMgZnVuY3Rpb24gZXhlY3V0ZSgpIHsgaWYgKCEkdGhpcy0+X2V4ZWN1dGVkKSB7ICR0aGlzLT5fZXhlY3V0ZWQgPSB0cnVlOyBpZiAoJHRoaXMtPnN1Y2Nlc3MpIHsgaWYgKCR0aGlzLT5fbWFpbCkgeyAkdGhpcy0+X21haWwtPnJvdyhhcnJheSgkdGhpcy0+XygnbGV0dGVyLXByb3BlcnRpZXMnKSksICd0b3AnKTsgJHRoaXMtPl9tYWlsLT5yb3coYXJyYXkoJHRoaXMtPl8oJ2xldHRlci1pbnN0YW5jZScpLCAkdGhpcy0+bmFtZSkpOyAkdGhpcy0+X21haWwtPnJvdyhhcnJheSgkdGhpcy0+XygnbGV0dGVyLXVybCcpLCAkX1NFUlZFUlsnSFRUUF9SRUZFUkVSJ10pKTsgJHRoaXMtPl9tYWlsLT5yb3coYXJyYXkoJHRoaXMtPl8oJ2xldHRlci1kYXRldGltZScpLCBkYXRlKCJZLW0tZCBIOmk6cyIpKSk7ICR0aGlzLT5fbWFpbC0+cm93KGFycmF5KCR0aGlzLT5fKCdsZXR0ZXItaXAnKSwgJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10pKTsgJGdlbyA9IEBmaWxlX2dldF9jb250ZW50cygnaHR0cDovL2FwaS5zeXBleGdlby5uZXQvanNvbi8nIC4gJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10pOyBpZiAoJGdlbykgeyAkZ2VvID0ganNvbl9kZWNvZGUoJGdlbyk7IGlmIChpc19vYmplY3QoJGdlbykgJiYgaXNzZXQoJGdlby0+Y2l0eS0+bmFtZV9ydSkpIHsgJHRoaXMtPl9tYWlsLT5yb3coYXJyYXkoJHRoaXMtPl8oJ2xldHRlci1jaXR5JyksICRnZW8tPmNpdHktPm5hbWVfcnUpKTsgfSB9ICRtYXJrID0gJHRoaXMtPnNvdXJjZSgnZm9ybV9tYXJrJyk7IGlmICgkbWFyaykgeyAkdGhpcy0+X21haWwtPnJvdyhhcnJheSgkdGhpcy0+XygnbGV0dGVyLW1hcmsnKSwgaHRtbHNwZWNpYWxjaGFycyhzdHJ2YWwoJG1hcmspKSkpOyB9ICR0aGlzLT5fbWFpbC0+cm93KGFycmF5KCR0aGlzLT5fKCdsZXR0ZXItZmllbGRzLWtleScpLCAkdGhpcy0+XygnbGV0dGVyLWZpZWxkcy12YWx1ZScpKSwgJ3RvcCcpOyBmb3JlYWNoICgkdGhpcy0+X2VudGl0eSBhcyAkZmllbGQpIHsgaWYgKCRmaWVsZC0+dHlwZSAmJiAkZmllbGQtPnR5cGUgIT0gJ3N1Ym1pdCcgJiYgJGZpZWxkLT5uYW1lKSB7ICR2YWx1ZSA9ICR0aGlzLT5fKCdsZXR0ZXItbWlzc2luZycpOyBzd2l0Y2ggKCRmaWVsZC0+dHlwZSkgeyBjYXNlICdjaGVja2JveCc6IGNhc2UgJ3JhZGlvJzogY2FzZSAnc2VsZWN0JzogaWYgKCRmaWVsZC0+bXVsdGlwbGUpIHsgaWYgKCFlbXB0eSgkZmllbGQtPnZhbHVlKSkgeyAkdmFsdWUgPSBhcnJheSgpOyBmb3JlYWNoICgkZmllbGQtPnZhbHVlIGFzICRyb3dLZXkpIHsgaWYgKGFycmF5X2tleV9leGlzdHMoJHJvd0tleSwgJGZpZWxkLT5yb3dzKSkgeyAkdmFsdWVbXSA9ICRmaWVsZC0+cm93c1skcm93S2V5XVsnY2FwdGlvbiddOyB9IH0gfSB9IGVsc2UgaWYgKGFycmF5X2tleV9leGlzdHMoJGZpZWxkLT52YWx1ZSwgJGZpZWxkLT5yb3dzKSkgeyAkdmFsdWUgPSAkZmllbGQtPnJvd3NbJGZpZWxkLT52YWx1ZV1bJ2NhcHRpb24nXTsgfSBicmVhazsgY2FzZSAnZmlsZSc6IGlmICgkZmllbGQtPm11bHRpcGxlKSB7IGlmICghZW1wdHkoJGZpZWxkLT52YWx1ZSkpIHsgJHZhbHVlID0gYXJyYXkoKTsgZm9yZWFjaCAoJGZpZWxkLT52YWx1ZSBhcyAkZmlsZSkgeyAkdmFsdWVbXSA9ICRmaWxlWyduYW1lJ107ICR0aGlzLT5fbWFpbC0+YXR0YWNoKGFycmF5KCdwYXRoJyA9PiAkZmlsZVsndG1wX25hbWUnXSwgJ25hbWUnID0+ICRmaWxlWyduYW1lJ10sICdDb250ZW50LVR5cGUnID0+ICRmaWxlWyd0eXBlJ10pKTsgfSB9IH0gZWxzZSBpZiAoJGZpZWxkLT52YWx1ZSkgeyAkdmFsdWUgPSAkZmllbGQtPnZhbHVlWyduYW1lJ107ICR0aGlzLT5fbWFpbC0+YXR0YWNoKGFycmF5KCdwYXRoJyA9PiAkZmllbGQtPnZhbHVlWyd0bXBfbmFtZSddLCAnbmFtZScgPT4gJGZpZWxkLT52YWx1ZVsnbmFtZSddLCAnQ29udGVudC1UeXBlJyA9PiAkZmllbGQtPnZhbHVlWyd0eXBlJ10pKTsgfSBicmVhazsgZGVmYXVsdDogaWYgKCRmaWVsZC0+dmFsdWUpIHsgJHZhbHVlID0gJGZpZWxkLT52YWx1ZTsgfSB9ICR0aGlzLT5fbWFpbC0+cm93KGFycmF5KCRmaWVsZC0+YWxpYXMgLiAnIFsnIC4gJGZpZWxkLT5uYW1lIC4gJ10nLCAkdmFsdWUpKTsgfSB9ICR0aGlzLT5fbWFpbC0+cm93KGFycmF5KCR0aGlzLT5odG1sKCdkaXYnLCBhcnJheSgnc3R5bGUnID0+ICd0ZXh0LWFsaWduOnJpZ2h0JyksICR0aGlzLT5odG1sKCdhJywgYXJyYXkoJ2hyZWYnID0+ICR0aGlzLT5fKCdsZXR0ZXItY29weXJpZ2h0LWhyZWYnKSwgJ3RhcmdldCcgPT4gJ19ibGFuaycsICdzdHlsZScgPT4gJ2NvbG9yOmluaGVyaXQ7Zm9udDppbmhlcml0JyksICR0aGlzLT5fKCdsZXR0ZXItY29weXJpZ2h0JykpKSksICdib3R0b20nKTsgfSBpZiAoISR0aGlzLT5fbWFpbCB8fCAkdGhpcy0+X21haWwtPnNlbmQoKSkgeyAkdGhpcy0+c3VjY2VzcyA9IHRydWU7IGlmICgkdGhpcy0+cmVzZXQpIHsgJHRoaXMtPnNlc3Npb24oJ2NsZWFuJyk7IGZvcmVhY2ggKCR0aGlzLT5fZW50aXR5IGFzICRmaWVsZCkgeyBpZiAoIWluX2FycmF5KCRmaWVsZC0+dHlwZSwgYXJyYXkoJ2J1dHRvbicsICdzdWJtaXQnLCAncmVzZXQnKSkpIHsgJGZpZWxkLT52YWx1ZSA9IG51bGw7IH0gfSB9ICR0aGlzLT5zZXNzaW9uKCdzZXQnLCAnbGFzdC1zZW5kJywgdGltZSgpKTsgaWYgKCR0aGlzLT5wcm90ZWN0aW9uKSB7ICR0aGlzLT5zZXNzaW9uKCdzZXQnLCAnaGFzaCcsICgkdGhpcy0+X2hhc2ggPSAoJHRoaXMtPnByb3RlY3Rpb24gPiAxID8gbWQ1KHRpbWUoKSAuIG10X3JhbmQoKSkgOiAkdGhpcy0+X2hhc2gpKSk7IH0gaWYgKCR0aGlzLT5zdWNjZXNzVGV4dCkgeyBhcnJheV91bnNoaWZ0KCR0aGlzLT5fYWxlcnRzLCAkdGhpcy0+aHRtbCgnZGl2JywgYXJyYXkoJ2NsYXNzJyA9PiAnd3dfX2Zvcm1fc3VjY2VzcycpLCAkdGhpcy0+c3VjY2Vzc1RleHQgLiAkdGhpcy0+aHRtbCgnc3BhbicsIGFycmF5KCdjbGFzcycgPT4gJ3d3X19mb3JtX3N1Y2Nlc3NfdGljaycpLCAkdGhpcy0+aHRtbCgnc3BhbicsIGFycmF5KCksICcnKSkpKTsgfSB9IGVsc2UgeyAkdGhpcy0+YWxlcnQoJHRoaXMtPl8oJ2Vycm9yLXN1Ym1pdCcpLCAncmVkJyk7IH0gfSB9IHJldHVybiAkdGhpczsgfSBwdWJsaWMgZnVuY3Rpb24gZmllbGQoJGZpZWxkKSB7IGlmIChpc19vYmplY3QoJGZpZWxkKSAmJiBnZXRfY2xhc3MoJGZpZWxkKSA9PSAnV1dfRm9ybV9GaWVsZCcpIHsgJHRoaXMtPmZpZWxkc1tdID0gJGZpZWxkOyB9IGVsc2UgeyAkdGhpcy0+ZmllbGRzW10gPSAkZmllbGQgPSBXV19Gb3JtX0ZpZWxkOjpmYWN0b3J5KCRmaWVsZCk7IH0gaWYgKCRmaWVsZC0+c3RlcCAmJiAoaXNfbnVsbCgkdGhpcy0+X3N0ZXBNYXgpIHx8ICRmaWVsZC0+c3RlcCA+ICR0aGlzLT5fc3RlcE1heCkpIHsgJHRoaXMtPl9zdGVwTWF4ID0gJGZpZWxkLT5zdGVwOyB9IHJldHVybiAkdGhpczsgfSBwdWJsaWMgZnVuY3Rpb24gZmllbGRzKGFycmF5ICRmaWVsZHMpIHsgZm9yZWFjaCAoJGZpZWxkcyBhcyAkcHJvcGVydGllcykgeyAkdGhpcy0+ZmllbGQoJHByb3BlcnRpZXMpOyB9IHJldHVybiAkdGhpczsgfSBwdWJsaWMgZnVuY3Rpb24gZmluZCgkcHJvcGVydHksICR2YWx1ZSkgeyBmb3JlYWNoIChhcnJheV9tZXJnZSgkdGhpcy0+ZmllbGRzLCAkdGhpcy0+Z3JvdXBzKSBhcyAkZW50aXR5KSB7IGlmIChwcm9wZXJ0eV9leGlzdHMoJGVudGl0eSwgJHByb3BlcnR5KSAmJiAkZW50aXR5LT57JHByb3BlcnR5fSA9PSAkdmFsdWUpIHsgcmV0dXJuICRlbnRpdHk7IH0gZWxzZSBpZiAobWV0aG9kX2V4aXN0cygkZW50aXR5LCAnZmluZCcpKSB7ICRmaW5kID0gJGVudGl0eS0+ZmluZCgkcHJvcGVydHksICR2YWx1ZSk7IGlmICgkZmluZCkgeyByZXR1cm4gJGZpbmQ7IH0gfSB9IHJldHVybiBudWxsOyB9IHB1YmxpYyBmdW5jdGlvbiBnZXQoKSB7ICR0aGlzLT5wcmVwYXJlKCk7ICR0aGlzLT5leGVjdXRlKCk7ICRtYXJrdXAgPSAnJzsgaWYgKCEkdGhpcy0+c3VjY2VzcyB8fCAkdGhpcy0+c3VjY2VzcyAmJiAhJHRoaXMtPmV4aXQpIHsgJGF0dHJpYnV0ZXMgPSBhcnJheSggJ2FjY2VwdC1jaGFyc2V0JyA9PiAndXRmLTgnLCAnYWN0aW9uJyA9PiAkdGhpcy0+YWN0aW9uLCAnY2xhc3MnID0+ICd3d19fZm9ybScsICdlbmN0eXBlJyA9PiAnbXVsdGlwYXJ0L2Zvcm0tZGF0YScsICdtZXRob2QnID0+ICR0aGlzLT5tZXRob2QsICduYW1lJyA9PiAkdGhpcy0+bmFtZSApOyBpZiAoJHRoaXMtPnByb3RlY3Rpb24pIHsgJG1hcmt1cCAuPSAkdGhpcy0+aHRtbCgnaW5wdXQnLCBhcnJheSgndHlwZScgPT4gJ2hpZGRlbicsICduYW1lJyA9PiAkdGhpcy0+X2tleSwgJ3ZhbHVlJyA9PiAkdGhpcy0+X2hhc2gpKTsgfSBpZiAoJHRoaXMtPl9zdGVwTWF4KSB7ICRtYXJrdXAgLj0gJHRoaXMtPmh0bWwoJ2lucHV0JywgYXJyYXkoJ3R5cGUnID0+ICdoaWRkZW4nLCAnbmFtZScgPT4gJ2Zvcm1fc3RlcCcsICd2YWx1ZScgPT4gJHRoaXMtPnN0ZXApKTsgfSBmb3JlYWNoIChhcnJheV9tZXJnZSgkdGhpcy0+ZmllbGRzLCAkdGhpcy0+Z3JvdXBzKSBhcyAkZW50aXR5KSB7IGlmICghJHRoaXMtPnN0ZXAgfHwgISRlbnRpdHktPnN0ZXAgfHwgJHRoaXMtPnN0ZXAgPT0gJGVudGl0eS0+c3RlcCkgeyAkbWFya3VwIC49ICRlbnRpdHktPmdldCgpOyB9IH0gJG1hcmt1cCA9ICR0aGlzLT5odG1sKCdmb3JtJywgJGF0dHJpYnV0ZXMsICRtYXJrdXApOyB9IHJldHVybiAkdGhpcy0+aHRtbCgnZGl2JywgYXJyYXkoJ2NsYXNzJyA9PiAnd3dfX2Zvcm1fY29udGFpbmVyJyksICR0aGlzLT5odG1sKCdkaXYnLCBhcnJheSgnY2xhc3MnID0+ICd3d19fZm9ybV9hbGVydHMnKSwgaW1wbG9kZSgnJywgJHRoaXMtPl9hbGVydHMpKSAuICRtYXJrdXApOyB9IHB1YmxpYyBmdW5jdGlvbiBncm91cCgkZ3JvdXApIHsgaWYgKGlzX29iamVjdCgkZ3JvdXApICYmIGdldF9jbGFzcygkZ3JvdXApID09ICdXV19Gb3JtX0dyb3VwJykgeyAkdGhpcy0+Z3JvdXBzW10gPSAkZ3JvdXA7IH0gZWxzZSB7ICR0aGlzLT5ncm91cHNbXSA9ICRncm91cCA9IFdXX0Zvcm1fR3JvdXA6OmZhY3RvcnkoJGdyb3VwKTsgfSBpZiAoJGdyb3VwLT5zdGVwICYmIChpc19udWxsKCR0aGlzLT5fc3RlcE1heCkgfHwgJGdyb3VwLT5zdGVwID4gJHRoaXMtPl9zdGVwTWF4KSkgeyAkdGhpcy0+X3N0ZXBNYXggPSAkZ3JvdXAtPnN0ZXA7IH0gcmV0dXJuICR0aGlzOyB9IHB1YmxpYyBmdW5jdGlvbiBncm91cHMoYXJyYXkgJGdyb3VwcykgeyBmb3JlYWNoICgkZ3JvdXBzIGFzICRwcm9wZXJ0aWVzKSB7ICR0aGlzLT5ncm91cCgkcHJvcGVydGllcyk7IH0gcmV0dXJuICR0aGlzOyB9IHB1YmxpYyBmdW5jdGlvbiBtYWlsKCRzZXR0aW5ncykgeyAkdGhpcy0+X21haWwgPSBXV19NYWlsOjpmYWN0b3J5KCRzZXR0aW5ncyk7IHJldHVybiAkdGhpczsgfSBwdWJsaWMgZnVuY3Rpb24gcHJlcGFyZSgpIHsgaWYgKCEkdGhpcy0+X3ByZXBhcmVkKSB7ICR0aGlzLT5fcHJlcGFyZWQgPSB0cnVlOyBpZiAoJHRoaXMtPm1ldGhvZCkgeyBpZiAoJHRoaXMtPm5hbWUpIHsgaWYgKCR0aGlzLT5hY3Rpb24pIHsgJHRoaXMtPnNlc3Npb24oJ3N0YXJ0Jyk7ICR0aGlzLT5zdGF0dXMgPSBpc3NldCgkX1NFUlZFUlsnSFRUUF9YX1JFUVVFU1RFRF9XSVRIJ10pICYmICFlbXB0eSgkX1NFUlZFUlsnSFRUUF9YX1JFUVVFU1RFRF9XSVRIJ10pICYmIHN0cnRvbG93ZXIoJF9TRVJWRVJbJ0hUVFBfWF9SRVFVRVNURURfV0lUSCddKSA9PSAneG1saHR0cHJlcXVlc3QnID8gJHRoaXMtPnNvdXJjZSgnd3dfX3N0YXR1cycsICdnZXQnKSA6IChlbXB0eSgkdGhpcy0+X3NvdXJjZSkgPyAnZ2V0JyA6ICdzdWJtaXQnKTsgaWYgKCEkdGhpcy0+cHJvdGVjdGlvbiB8fCAkdGhpcy0+X3Byb3RlY3Rpb24oKSkgeyAkdGhpcy0+c3RlcCA9ICR0aGlzLT5fc3RlcE1heCAmJiAkdGhpcy0+X3N0ZXBNYXggPiAxID8gJHRoaXMtPnNvdXJjZSgnZm9ybV9zdGVwJywgMSkgOiBudWxsOyAkdGhpcy0+X2VudGl0eSA9ICR0aGlzLT5maWVsZHM7IGZvcmVhY2ggKCR0aGlzLT5ncm91cHMgYXMgJGdyb3VwKSB7ICRncm91cC0+cHJlcGFyZSgkdGhpcyk7ICR0aGlzLT5fZW50aXR5ID0gYXJyYXlfbWVyZ2UoJHRoaXMtPl9lbnRpdHksICRncm91cC0+ZmllbGRzKTsgfSBmb3JlYWNoICgkdGhpcy0+X2VudGl0eSBhcyAkZmllbGQpIHsgJGZpZWxkLT5wcmVwYXJlKCR0aGlzKTsgfSBpZiAoJHRoaXMtPnN0YXR1cyA9PSAnc3VibWl0JykgeyAkc3VjY2VzcyA9IGZhbHNlOyBpZiAoJHRoaXMtPnN0ZXApIHsgJHZhbGlkID0gJHRoaXMtPnN0ZXA7IGZvciAoJGkgPSAxOyAkaSA8PSAkdGhpcy0+c3RlcDsgJGkrKykgeyBmb3JlYWNoICgkdGhpcy0+X2VudGl0eSBhcyAkZmllbGQpIHsgaWYgKCRmaWVsZC0+c3RlcCA9PSAkaSAmJiAhJGZpZWxkLT5jaGVjaygpICYmICRmaWVsZC0+c3RlcCA8PSAkdmFsaWQpIHsgJHZhbGlkID0gJGZpZWxkLT5zdGVwIC0gMTsgfSB9IH0gaWYgKCR2YWxpZCA9PSAkdGhpcy0+c3RlcCkgeyAkdmFsaWQgPT0gJHRoaXMtPl9zdGVwTWF4ID8gJHN1Y2Nlc3MgPSB0cnVlIDogJHRoaXMtPnN0ZXArKzsgfSAkdGhpcy0+c2Vzc2lvbignc2V0JywgJ3N0ZXAnLCAkdGhpcy0+c3RlcCk7IH0gZWxzZSB7ICRlcnJvcnMgPSAwOyBmb3JlYWNoICgkdGhpcy0+X2VudGl0eSBhcyAkZmllbGQpIHsgISRmaWVsZC0+Y2hlY2soKSAmJiAkZXJyb3JzKys7IH0gJGVycm9ycyA9PT0gMCAmJiAkc3VjY2VzcyA9IHRydWU7IH0gaWYgKCRzdWNjZXNzKSB7ICRsYXN0ID0gJHRoaXMtPnNlc3Npb24oJ2dldCcsICdsYXN0LXNlbmQnKTsgJHJlc2lkdWUgPSAhaXNfbnVsbCgkbGFzdCkgPyAkbGFzdCArICR0aGlzLT5pbnRlcnZhbCAtIHRpbWUoKSA6IG51bGw7IGlmIChpc19udWxsKCRyZXNpZHVlKSB8fCAkcmVzaWR1ZSA8PSAwKSB7ICR0aGlzLT5zdWNjZXNzID0gdHJ1ZTsgfSBlbHNlIHsgJHRoaXMtPmFsZXJ0KCR0aGlzLT5fKCdlcnJvci1pbnRlcnZhbCcsIGFycmF5KCdpbnRlcnZhbCcgPT4gJHJlc2lkdWUpKSwgJ3JlZCcpOyB9IH0gfSB9IGVsc2UgeyAkdGhpcy0+YWxlcnQoJHRoaXMtPl8oJ2Vycm9yLXByb3RlY3Rpb24nKSwgJ3JlZCcpOyB9IH0gZWxzZSB7ICR0aGlzLT5hbGVydCgkdGhpcy0+XygnZXJyb3ItYWN0aW9uJyksICdyZWQnKTsgfSB9IGVsc2UgeyAkdGhpcy0+YWxlcnQoJHRoaXMtPl8oJ2Vycm9yLW5hbWUnKSwgJ3JlZCcpOyB9IH0gZWxzZSB7ICR0aGlzLT5hbGVydCgkdGhpcy0+XygnZXJyb3ItbWV0aG9kJyksICdyZWQnKTsgfSB9IHJldHVybiAkdGhpczsgfSBwdWJsaWMgZnVuY3Rpb24gc2Vzc2lvbigkbWV0aG9kLCAkcHJvcGVydHkgPSBudWxsLCAkdmFsdWUgPSBudWxsKSB7IHN3aXRjaCAoJG1ldGhvZCkgeyBjYXNlICdjbGVhbic6ICRfU0VTU0lPTlskdGhpcy0+bmFtZV0gPSBhcnJheSgpOyBicmVhazsgY2FzZSAnZ2V0JzogcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJHByb3BlcnR5LCAkX1NFU1NJT05bJHRoaXMtPm5hbWVdKSA/ICRfU0VTU0lPTlskdGhpcy0+bmFtZV1bJHByb3BlcnR5XSA6ICR2YWx1ZTsgYnJlYWs7IGNhc2UgJ3JlbW92ZSc6IHVuc2V0KCRfU0VTU0lPTlskdGhpcy0+bmFtZV1bJHByb3BlcnR5XSk7IGJyZWFrOyBjYXNlICdzZXQnOiAkX1NFU1NJT05bJHRoaXMtPm5hbWVdWyRwcm9wZXJ0eV0gPSAkdmFsdWU7IGJyZWFrOyBjYXNlICdzdGFydCc6ICFzZXNzaW9uX2lkKCkgJiYgQHNlc3Npb25fc3RhcnQoKTsgaWYgKCFhcnJheV9rZXlfZXhpc3RzKCR0aGlzLT5uYW1lLCAkX1NFU1NJT04pKSB7ICR0aGlzLT5zZXNzaW9uKCdjbGVhbicpOyB9IGJyZWFrOyB9IHJldHVybiAkdGhpczsgfSBwdWJsaWMgZnVuY3Rpb24gc291cmNlKCRoYW5kbGUsICRkZWZhdWx0ID0gbnVsbCkgeyBpZiAoaXNfYXJyYXkoJGhhbmRsZSkpIHsgJHRoaXMtPl9zb3VyY2UgPSAkaGFuZGxlOyByZXR1cm4gJHRoaXM7IH0gcmV0dXJuIGFycmF5X2tleV9leGlzdHMoJGhhbmRsZSwgJHRoaXMtPl9zb3VyY2UpID8gJHRoaXMtPl9zb3VyY2VbJGhhbmRsZV0gOiAkZGVmYXVsdDsgfSBwcm90ZWN0ZWQgZnVuY3Rpb24gX3Byb3RlY3Rpb24oKSB7ICRhY2Nlc3MgPSBmYWxzZTsgaWYgKGluX2FycmF5KCR0aGlzLT5zdGF0dXMsIGFycmF5KCdjaGVjaycsICdnZXQnLCAnZ3JvdXAtYWRkJywgJ2dyb3VwLXJlbW92ZScsICdzdWJtaXQnKSkpIHsgJHRoaXMtPl9rZXkgPSBtZDUoJF9TRVJWRVJbJ1JFTU9URV9BRERSJ10gLiAkX1NFUlZFUlsnSFRUUF9VU0VSX0FHRU5UJ10gLiAkdGhpcy0+bmFtZSAuIHNlc3Npb25faWQoKSk7ICR0aGlzLT5faGFzaCA9ICR0aGlzLT5zZXNzaW9uKCdnZXQnLCAnaGFzaCcpOyBpZiAoJHRoaXMtPnN0YXR1cyA9PSAnZ2V0JykgeyBpZiAoISR0aGlzLT5faGFzaCkgeyAkdGhpcy0+c2Vzc2lvbignc2V0JywgJ2hhc2gnLCAkdGhpcy0+X2hhc2ggPSAobWQ1KHRpbWUoKSAuIG10X3JhbmQoKSkpKTsgfSAkYWNjZXNzID0gdHJ1ZTsgfSBlbHNlIGlmICgkdGhpcy0+X2hhc2ggPT09ICR0aGlzLT5zb3VyY2UoJHRoaXMtPl9rZXkpKSB7ICRhY2Nlc3MgPSB0cnVlOyB9IH0gcmV0dXJuICRhY2Nlc3M7IH0gfSBjbGFzcyBXV19Gb3JtX0ZpZWxkIGV4dGVuZHMgV1dfRW50aXR5IHsgcHVibGljICRhbGlhczsgcHVibGljICRhdHRyaWJ1dGVzOyBwdWJsaWMgJGF0dHJpYnV0ZXNDb250YWluZXI7IHB1YmxpYyAkYXV0b3Jlc2l6ZTsgcHVibGljICRiaW5kOyBwdWJsaWMgJGNhcHRpb247IHB1YmxpYyAkZW1iZWQ7IHB1YmxpYyAkZXJyb3I7IHB1YmxpYyAkbGFiZWw7IHB1YmxpYyAkbWFya3VwOyBwdWJsaWMgJG11bHRpcGxlOyBwdWJsaWMgJG5hbWU7IHB1YmxpYyAkcm93czsgcHVibGljICRydWxlczsgcHVibGljICRzY3JlZW4gPSB0cnVlOyBwdWJsaWMgJHN0ZXA7IHB1YmxpYyAkc3RvcmluZyA9IGZhbHNlOyBwdWJsaWMgJHRpdGxlOyBwdWJsaWMgJHR5cGUgPSAndGV4dCc7IHB1YmxpYyAkdmFsdWU7IHB1YmxpYyAkd2F0Y2ggPSB0cnVlOyBwcm90ZWN0ZWQgJF8gPSBhcnJheSggJ3JlcXVpcmVkJyA9PiAn0J/QvtC20LDQu9GD0LnRgdGC0LAsINC30LDQv9C+0LvQvdC40YLQtSDQv9C+0LvQtSEnLCAnbGVuZ3RoLW1pbicgPT4gJ9Cc0LjQvdC40LzRg9C8INGB0LjQvNCy0L7Qu9C+0LI6ICMjX1NFVFRJTkdfIyMnLCAnbGVuZ3RoLW1heCcgPT4gJ9Cc0LDQutGB0LjQvNGD0Lwg0YHQuNC80LLQvtC70L7QsjogIyNfU0VUVElOR18jIycsICdwYXR0ZXJuLWVtYWlsJyA9PiAn0J/RgNC40LzQtdGAOiBleGFtcGxlQG1haWwucnUnLCAncGF0dGVybi1pcCcgPT4gJ9Cf0YDQuNC80LXRgDogMTkyLjE2OC4wLjEnLCAncGF0dGVybi1sb2dpbicgPT4gJzYtMjAg0LvQsNGC0LjQvdGB0LrQuNGFINCx0YPQutCyINC4fNC40LvQuCDRhtC40YTRgCcsICdwYXR0ZXJuLW1vYmlsZScgPT4gJ9Cf0YDQuNC80LXRgDogKzcgOTk5IDg4OC03Ny02NicsICdwYXR0ZXJuLXBhc3N3b3JkJyA9PiAnNi0yMCDQu9Cw0YLQuNC90YHQutC40YUg0LHRg9C60LIg0Lh80LjQu9C4INGG0LjRhNGALicsICdwYXR0ZXJuLXBob25lJyA9PiAn0J/RgNC40LzQtdGAOiA5OTktODgtNzcnLCAncGF0dGVybi11cmwnID0+ICfQn9GA0LjQvNC10YA6IGh0dHA6Ly9leGFtcGxlLnJ1JywgJ3NpemUtbWluJyA9PiAn0KDQsNC30LzQtdGAINGE0LDQudC70LAg0LzQtdC90LXQtSAjI19TRVRUSU5HXyMjIEtiLicsICdzaXplLW1heCcgPT4gJ9Cg0LDQt9C80LXRgCDRhNCw0LnQu9CwINC/0YDQtdCy0YvRiNCw0LXRgiAjI19TRVRUSU5HXyMjIEtiLicsICdmb3JtYXRzJyA9PiAn0JTQvtC/0YPRgdGC0LjQvNGL0LUg0YTQvtGA0LzQsNGC0Ysg0YTQsNC50LvQvtCyOiAjI19TRVRUSU5HXyMjLicgKTsgcHJvdGVjdGVkICRfcGF0dGVybnMgPSBhcnJheSggJ3BhdHRlcm4tZW1haWwnID0+ICdGSUxURVJfVkFMSURBVEVfRU1BSUwnLCAncGF0dGVybi1pcCcgPT4gJ0ZJTFRFUl9WQUxJREFURV9JUCcsICdwYXR0ZXJuLWxvZ2luJyA9PiAnL14oW2EtejAtOVwtX0AuXXs2LDIwfSkkL2knLCAncGF0dGVybi1tb2JpbGUnID0+ICcvXigoOHxcKzcpW1wtIF0/KT8oXCg/XGR7M31cKT9bXC0gXT8pP1tcZFwtIF17NywxMH0kLycsICdwYXR0ZXJuLXBhc3N3b3JkJyA9PiAnL14oW2EtejAtOVwtX0AuXXs2LDIwfSkkL2knLCAncGF0dGVybi1waG9uZScgPT4gJy9eKFswLTkgXC0rKCldezUsMjJ9KSQvJywgJ3BhdHRlcm4tdXJsJyA9PiAnRklMVEVSX1ZBTElEQVRFX1VSTCcsICk7IHByb3RlY3RlZCAkX3ByZXBhcmVkOyBwdWJsaWMgZnVuY3Rpb24gY2hlY2soKSB7IGlmICgkdGhpcy0+dHlwZSAmJiAkdGhpcy0+bmFtZSAmJiBpc19hcnJheSgkdGhpcy0+cnVsZXMpKSB7IGZvcmVhY2ggKCR0aGlzLT5ydWxlcyBhcyAkcnVsZSkgeyBpZiAoaXNfYXJyYXkoJHJ1bGUpICYmIGFycmF5X2tleV9leGlzdHMoJ3J1bGUnLCAkcnVsZSkpIHsgJHJlcGxhY2UgPSBhcnJheSggJ2FsaWFzJyA9PiAkdGhpcy0+YWxpYXMgPyAkdGhpcy0+YWxpYXMgOiAkdGhpcy0+bmFtZSwgJ3ZhbHVlJyA9PiBpc19zdHJpbmcoJHRoaXMtPnZhbHVlKSA/ICR0aGlzLT52YWx1ZSA6ICcnICk7IGlmIChhcnJheV9rZXlfZXhpc3RzKCdzZXR0aW5nJywgJHJ1bGUpKSB7ICRyZXBsYWNlWydzZXR0aW5nJ10gPSBpc19hcnJheSgkcnVsZVsnc2V0dGluZyddKSA/IGltcGxvZGUoJywgJywgJHJ1bGVbJ3NldHRpbmcnXSkgOiBzdHJ2YWwoJHJ1bGVbJ3NldHRpbmcnXSk7IH0gaWYgKGlzX2NhbGxhYmxlKCRydWxlWydydWxlJ10pKSB7ICRjaGVjayA9IGNhbGxfdXNlcl9mdW5jKCRydWxlWydydWxlJ10pOyB9IGVsc2UgeyBpZiAoJHRoaXMtPm11bHRpcGxlICYmICFlbXB0eSgkdGhpcy0+dmFsdWUpKSB7ICRjaGVjayA9IHRydWU7IGZvcmVhY2ggKCR0aGlzLT52YWx1ZSBhcyAkdmFsdWUpIHsgaWYgKCEoJGNoZWNrID0gJHRoaXMtPl9jaGVjaygkcnVsZSwgJHZhbHVlKSkpIHsgJHJlcGxhY2VbJ3ZhbHVlJ10gPSAkdmFsdWU7IGJyZWFrOyB9IH0gfSBlbHNlIHsgJGNoZWNrID0gJHRoaXMtPl9jaGVjaygkcnVsZSwgJHRoaXMtPnZhbHVlKTsgfSB9IGlmICghJGNoZWNrKSB7ICR0aGlzLT5lcnJvciA9ICR0aGlzLT5fKGFycmF5X2tleV9leGlzdHMoJ2NvbnRleHQnLCAkcnVsZSkgPyAkcnVsZVsnY29udGV4dCddIDogJHJ1bGVbJ3J1bGUnXSwgJHJlcGxhY2UpOyByZXR1cm4gZmFsc2U7IH0gfSB9IH0gcmV0dXJuIHRydWU7IH0gcHVibGljIGZ1bmN0aW9uIGdldCgpIHsgaWYgKCR0aGlzLT5tYXJrdXApIHsgcmV0dXJuIHN0cnZhbCgkdGhpcy0+bWFya3VwKTsgfSBlbHNlIHsgJG1hcmt1cCA9ICR0aGlzLT5jYXB0aW9uID8gJHRoaXMtPmh0bWwoJ2RpdicsIGFycmF5KCdjbGFzcycgPT4gJ3d3X19maWVsZF9jYXB0aW9uJywgJ3RpdGxlJyA9PiAkdGhpcy0+Y2FwdGlvbiksICR0aGlzLT5jYXB0aW9uKSA6ICcnOyAkYXR0cmlidXRlc0NvbnRhaW5lciA9IGlzX2FycmF5KCR0aGlzLT5hdHRyaWJ1dGVzQ29udGFpbmVyKSA/ICR0aGlzLT5hdHRyaWJ1dGVzQ29udGFpbmVyIDogYXJyYXkoKTsgJGF0dHJpYnV0ZXNDb250YWluZXJbJ2NsYXNzJ10gPSAnd3dfX2ZpZWxkX2NvbnRhaW5lcic7ICRhdHRyaWJ1dGVzQ29udGFpbmVyWyd3dy10eXBlJ10gPSAkdGhpcy0+dHlwZTsgaWYgKCR0aGlzLT5iaW5kKSB7ICRhdHRyaWJ1dGVzQ29udGFpbmVyWyd3dy1iaW5kJ10gPSBudWxsOyB9IGlmICgkdGhpcy0+d2F0Y2gpIHsgJGF0dHJpYnV0ZXNDb250YWluZXJbJ3d3LXdhdGNoJ10gPSBudWxsOyB9IGlmICgkdGhpcy0+ZW1iZWQpIHsgJG1hcmt1cCAuPSBzdHJ2YWwoJHRoaXMtPmVtYmVkKTsgfSBlbHNlIHsgJGF0dHJpYnV0ZXMgPSBpc19hcnJheSgkdGhpcy0+YXR0cmlidXRlcykgPyAkdGhpcy0+YXR0cmlidXRlcyA6IGFycmF5KCk7ICRhdHRyaWJ1dGVzWydpZCddID0gJHRoaXMtPmlkOyBpZiAoJHRoaXMtPm5hbWUpIHsgJGF0dHJpYnV0ZXNbJ25hbWUnXSA9ICR0aGlzLT5tdWx0aXBsZSA/ICR0aGlzLT5uYW1lIC4gJ1tdJyA6ICR0aGlzLT5uYW1lOyB9IHN3aXRjaCAoJHRoaXMtPnR5cGUpIHsgY2FzZSAnYnV0dG9uJzogJG1hcmt1cCAuPSAkdGhpcy0+aHRtbCgnYnV0dG9uJywgJGF0dHJpYnV0ZXMsIHN0cnZhbCgkdGhpcy0+dmFsdWUpKTsgYnJlYWs7IGNhc2UgJ3RleHRhcmVhJzogaWYgKCR0aGlzLT5uYW1lKSB7IGlmICgkdGhpcy0+YXV0b3Jlc2l6ZSkgeyAkYXR0cmlidXRlc1snd3ctYXV0b3Jlc2l6ZSddID0gbnVsbDsgfSAkbWFya3VwIC49ICR0aGlzLT5odG1sKCd0ZXh0YXJlYScsICRhdHRyaWJ1dGVzLCBzdHJ2YWwoJHRoaXMtPnZhbHVlKSk7ICRtYXJrdXAgLj0gJHRoaXMtPmh0bWwoJ2RpdicsIGFycmF5KCdjbGFzcycgPT4gJ3d3X19maWVsZF9hZGRpdGlvbmFsJyksICR0aGlzLT5odG1sKCdkaXYnLCBhcnJheSgpLCAnJykpOyB9IGJyZWFrOyBjYXNlICdjaGVja2JveCc6IGNhc2UgJ3JhZGlvJzogaWYgKCR0aGlzLT5uYW1lICYmIGlzX2FycmF5KCR0aGlzLT5yb3dzKSkgeyBmb3JlYWNoICgkdGhpcy0+cm93cyBhcyAkcm93S2V5ID0+ICRyb3cpIHsgaWYgKGlzX2FycmF5KCRyb3cpKSB7ICRyb3dBdHRyaWJ1dGVzID0gYXJyYXlfa2V5X2V4aXN0cygnYXR0cmlidXRlcycsICRyb3cpICYmIGlzX2FycmF5KCRyb3dbJ2F0dHJpYnV0ZXMnXSkgPyAkcm93WydhdHRyaWJ1dGVzJ10gOiBhcnJheSgpOyAkcm93QXR0cmlidXRlc1snaWQnXSA9ICRhdHRyaWJ1dGVzWydpZCddIC4gJ18nIC4gJHJvd0tleTsgJHJvd0F0dHJpYnV0ZXNbJ25hbWUnXSA9ICRhdHRyaWJ1dGVzWyduYW1lJ107ICRyb3dBdHRyaWJ1dGVzWyd0eXBlJ10gPSAkdGhpcy0+dHlwZTsgJHJvd0F0dHJpYnV0ZXNbJ3ZhbHVlJ10gPSAkcm93S2V5OyBpZiAoJHRoaXMtPm11bHRpcGxlICYmIGlzX2FycmF5KCR0aGlzLT52YWx1ZSkgJiYgaW5fYXJyYXkoJHJvd0tleSwgJHRoaXMtPnZhbHVlKSB8fCAhJHRoaXMtPm11bHRpcGxlICYmICR0aGlzLT52YWx1ZSA9PSAkcm93S2V5KSB7ICRyb3dBdHRyaWJ1dGVzWydjaGVja2VkJ10gPSBudWxsOyB9ICRyb3dNYXJrdXAgPSAkdGhpcy0+aHRtbCgnaW5wdXQnLCAkcm93QXR0cmlidXRlcyk7ICRyb3dNYXJrdXAgLj0gJHRoaXMtPmh0bWwoJ3NwYW4nLCBhcnJheSgnY2xhc3MnID0+ICd3d19fZmllbGRfYWRkaXRpb25hbCcpLCAkdGhpcy0+aHRtbCgnc3BhbicsIGFycmF5KCksICR0aGlzLT5odG1sKCdzcGFuJywgYXJyYXkoKSwgJycpKSk7ICRyb3dNYXJrdXAgLj0gJHRoaXMtPmh0bWwoJ3NwYW4nLCBhcnJheSgnY2xhc3MnID0+ICd3d19fZmllbGRfcm93X2NhcHRpb24nKSwgc3RydmFsKCRyb3dbJ2NhcHRpb24nXSkpOyAkbWFya3VwIC49ICR0aGlzLT5odG1sKCdkaXYnLCBhcnJheSgnY2xhc3MnID0+ICd3d19fZmllbGRfcm93JyksICR0aGlzLT5odG1sKCdsYWJlbCcsIGFycmF5KCksICRyb3dNYXJrdXApKTsgfSB9IH0gYnJlYWs7IGNhc2UgJ3NlbGVjdCc6IGlmICgkdGhpcy0+bmFtZSAmJiBpc19hcnJheSgkdGhpcy0+cm93cykpIHsgJHJvd3MgPSAkcm93c0FkZGl0aW9uYWwgPSAkcm93QWRkaXRpb25hbFZhbHVlID0gJyc7IGZvcmVhY2ggKCR0aGlzLT5yb3dzIGFzICRyb3dLZXkgPT4gJHJvdykgeyBpZiAoaXNfYXJyYXkoJHJvdykpIHsgJHJvd0FkZGl0aW9uYWxBdHRyaWJ1dGVzID0gYXJyYXkoJ3d3LXZhbHVlJyA9PiAkcm93S2V5KTsgJHJvd0F0dHJpYnV0ZXMgPSBhcnJheV9rZXlfZXhpc3RzKCdhdHRyaWJ1dGVzJywgJHJvdykgJiYgaXNfYXJyYXkoJHJvd1snYXR0cmlidXRlcyddKSA/ICRyb3dbJ2F0dHJpYnV0ZXMnXSA6IGFycmF5KCk7ICRyb3dBdHRyaWJ1dGVzWyd2YWx1ZSddID0gJHJvd0tleTsgJHJvd0NhcHRpb24gPSBzdHJ2YWwoJHJvd1snY2FwdGlvbiddKTsgaWYgKCR0aGlzLT5tdWx0aXBsZSAmJiBpc19hcnJheSgkdGhpcy0+dmFsdWUpICYmIGluX2FycmF5KCRyb3dLZXksICR0aGlzLT52YWx1ZSkgfHwgISR0aGlzLT5tdWx0aXBsZSAmJiAkdGhpcy0+dmFsdWUgPT0gJHJvd0tleSkgeyAkcm93QWRkaXRpb25hbEF0dHJpYnV0ZXNbJ3d3LXNlbGVjdGVkJ10gPSAkcm93QXR0cmlidXRlc1snc2VsZWN0ZWQnXSA9IG51bGw7ICRyb3dBZGRpdGlvbmFsVmFsdWUgPSAkcm93Q2FwdGlvbjsgfSBlbHNlIGlmICghJHJvd0FkZGl0aW9uYWxWYWx1ZSkgeyAkcm93QWRkaXRpb25hbFZhbHVlID0gJHJvd0NhcHRpb247IH0gaWYgKGFycmF5X2tleV9leGlzdHMoJ2Rpc2FibGVkJywgJHJvd0F0dHJpYnV0ZXMpKSB7ICRyb3dBZGRpdGlvbmFsQXR0cmlidXRlc1snd3ctZGlzYWJsZWQnXSA9IG51bGw7IH0gJHJvd3MgLj0gJHRoaXMtPmh0bWwoJ29wdGlvbicsICRyb3dBdHRyaWJ1dGVzLCAkcm93Q2FwdGlvbik7ICRyb3dzQWRkaXRpb25hbCAuPSAkdGhpcy0+aHRtbCgnbGknLCAkcm93QWRkaXRpb25hbEF0dHJpYnV0ZXMsICRyb3dDYXB0aW9uKTsgfSB9ICRtYXJrdXAgLj0gJHRoaXMtPmh0bWwoJ3NlbGVjdCcsICRhdHRyaWJ1dGVzLCAkcm93cyk7ICRtYXJrdXAgLj0gJHRoaXMtPmh0bWwoJ2RpdicsIGFycmF5KCdjbGFzcycgPT4gJ3d3X19maWVsZF9hZGRpdGlvbmFsJyksICR0aGlzLT5odG1sKCdkaXYnLCBhcnJheSgpLCAkcm93QWRkaXRpb25hbFZhbHVlKSAuICR0aGlzLT5odG1sKCd1bCcsIGFycmF5KCksICRyb3dzQWRkaXRpb25hbCkpOyB9IGJyZWFrOyBjYXNlICdmaWxlJzogaWYgKCR0aGlzLT5uYW1lKSB7IGlmICgkdGhpcy0+bXVsdGlwbGUpIHsgJGF0dHJpYnV0ZXNbJ211bHRpcGxlJ10gPSBudWxsOyB9ICRhdHRyaWJ1dGVzWyd0eXBlJ10gPSAnZmlsZSc7ICRtYXJrdXAgLj0gJHRoaXMtPmh0bWwoJ2lucHV0JywgJGF0dHJpYnV0ZXMpOyAkbWFya3VwIC49ICR0aGlzLT5odG1sKCdsYWJlbCcsIGFycmF5KCdjbGFzcycgPT4gJ3d3X19maWVsZF9hZGRpdGlvbmFsJywgJ2ZvcicgPT4gJHRoaXMtPmlkKSwgKCR0aGlzLT5sYWJlbCA/ICR0aGlzLT5sYWJlbCA6ICR0aGlzLT5hbGlhcykpOyB9IGJyZWFrOyBkZWZhdWx0OiAkYXR0cmlidXRlc1sndHlwZSddID0gJHRoaXMtPnR5cGU7ICRhdHRyaWJ1dGVzWyd2YWx1ZSddID0gJHRoaXMtPnZhbHVlOyAkbWFya3VwIC49ICR0aGlzLT5odG1sKCdpbnB1dCcsICRhdHRyaWJ1dGVzKTsgaWYgKCR0aGlzLT50eXBlICE9ICdoaWRkZW4nKSB7ICRtYXJrdXAgLj0gJHRoaXMtPmh0bWwoJ2RpdicsIGFycmF5KCdjbGFzcycgPT4gJ3d3X19maWVsZF9hZGRpdGlvbmFsJyksICR0aGlzLT5odG1sKCdkaXYnLCBhcnJheSgpLCAnJykpOyB9IGlmICgkdGhpcy0+cm93cykgeyAkcm93cyA9ICcnOyBmb3JlYWNoICgkdGhpcy0+cm93cyBhcyAkcm93KSB7ICRjYXB0aW9uID0gaXNfYXJyYXkoJHJvdykgPyAkcm93WydjYXB0aW9uJ10gOiBzdHJ2YWwoJHJvdyk7ICRyb3dzIC49ICR0aGlzLT5odG1sKCdsaScsIGFycmF5KCksICRjYXB0aW9uKTsgfSAkbWFya3VwIC49ICR0aGlzLT5odG1sKCd1bCcsIGFycmF5KCdjbGFzcycgPT4gJ3d3X19maWVsZF9yb3dzJyksICRyb3dzKTsgfSB9IH0gaWYgKGlzX2FycmF5KCR0aGlzLT5ydWxlcykpIHsgZm9yZWFjaCAoJHRoaXMtPnJ1bGVzIGFzICRydWxlKSB7IGlmIChhcnJheV9rZXlfZXhpc3RzKCdydWxlJywgJHJ1bGUpICYmICRydWxlWydydWxlJ10gPT0gJ3JlcXVpcmVkJykgeyAkYXR0cmlidXRlc0NvbnRhaW5lclsnd3ctcmVxdWlyZWQnXSA9IG51bGw7IH0gfSBpZiAoJHRoaXMtPmVycm9yKSB7ICRhdHRyaWJ1dGVzQ29udGFpbmVyWydjbGFzcyddIC49ICcgd3dfX2ZpZWxkX2ludmFsaWQnOyB9ICRtYXJrdXAgLj0gJHRoaXMtPmh0bWwoJ2RpdicsIGFycmF5KCdjbGFzcycgPT4gJ3d3X19maWVsZF9lcnJvcicpLCBzdHJ2YWwoJHRoaXMtPmVycm9yKSk7IH0gJG1hcmt1cCA9ICR0aGlzLT5odG1sKCdkaXYnLCBhcnJheSgnY2xhc3MnID0+ICd3d19fZmllbGQnKSwgJG1hcmt1cCk7IGlmICgkdGhpcy0+dGl0bGUpIHsgJG1hcmt1cCA9ICR0aGlzLT5odG1sKCdkaXYnLCBhcnJheSgnY2xhc3MnID0+ICd3d19fZmllbGRfdGl0bGUnKSwgKCR0aGlzLT5yb3dzID8gJHRoaXMtPnRpdGxlIDogJHRoaXMtPmh0bWwoJ2xhYmVsJywgYXJyYXkoJ2ZvcicgPT4gJHRoaXMtPmlkKSwgJHRoaXMtPnRpdGxlKSkpIC4gJG1hcmt1cDsgfSByZXR1cm4gJHRoaXMtPmh0bWwoJ2RpdicsICRhdHRyaWJ1dGVzQ29udGFpbmVyLCAkbWFya3VwKTsgfSB9IHB1YmxpYyBmdW5jdGlvbiBwcmVwYXJlKFdXX0Zvcm0gJGZvcm0pIHsgaWYgKCEkdGhpcy0+X3ByZXBhcmVkKSB7ICR0aGlzLT5fcHJlcGFyZWQgPSB0cnVlOyBpZiAoJHRoaXMtPm5hbWUgJiYgJHRoaXMtPnR5cGUgJiYgIWluX2FycmF5KCR0aGlzLT50eXBlLCBhcnJheSgnYnV0dG9uJywgJ3N1Ym1pdCcsICdyZXNldCcpKSkgeyAkdGhpcy0+c3RvcmluZyA9ICR0aGlzLT5zdG9yaW5nIHx8ICR0aGlzLT5zdGVwICYmICRmb3JtLT5zdGF0dXMgIT0gJ2NoZWNrJzsgJHRoaXMtPmFsaWFzID0gJHRoaXMtPmFsaWFzID8gJHRoaXMtPmFsaWFzIDogJHRoaXMtPm5hbWU7IGlmICgkdGhpcy0+dHlwZSA9PSAnZmlsZScpIHsgaWYgKGFycmF5X2tleV9leGlzdHMoJHRoaXMtPm5hbWUsICRfRklMRVMpKSB7IGlmICgkdGhpcy0+bXVsdGlwbGUpIHsgJHRoaXMtPnZhbHVlID0gYXJyYXkoKTsgZm9yICgkaSA9IDA7ICRpIDwgY291bnQoJF9GSUxFU1skdGhpcy0+bmFtZV1bJ25hbWUnXSk7ICRpKyspIHsgaWYgKCRfRklMRVNbJHRoaXMtPm5hbWVdWydlcnJvciddWyRpXSA9PSAwKSB7IGZvcmVhY2ggKGFycmF5X2tleXMoJF9GSUxFU1skdGhpcy0+bmFtZV0pIGFzICRrZXkpIHsgJHRoaXMtPnZhbHVlWyRpXVska2V5XSA9ICRfRklMRVNbJHRoaXMtPm5hbWVdWyRrZXldWyRpXTsgfSB9IH0gfSBlbHNlIGlmICgkX0ZJTEVTWyR0aGlzLT5uYW1lXVsnZXJyb3InXSA9PSAwKSB7ICR0aGlzLT52YWx1ZSA9ICRfRklMRVNbJHRoaXMtPm5hbWVdOyB9IH0gfSBlbHNlIHsgaWYgKCRyZXF1ZXN0ID0gJGZvcm0tPnNvdXJjZSgkdGhpcy0+bmFtZSkpIHsgaWYgKCR0aGlzLT5zY3JlZW4pIHsgaWYgKGlzX2FycmF5KCRyZXF1ZXN0KSkgeyAkb3JpZ2luYWwgPSAkcmVxdWVzdDsgJHJlcXVlc3QgPSBhcnJheSgpOyBmb3JlYWNoICgkb3JpZ2luYWwgYXMgJGtleSA9PiAkdmFsKSB7ICRyZXF1ZXN0WyRrZXldID0gdHJpbShodG1sc3BlY2lhbGNoYXJzKHN0cnZhbCgkdmFsKSkpOyB9IH0gZWxzZSB7ICRyZXF1ZXN0ID0gdHJpbShodG1sc3BlY2lhbGNoYXJzKHN0cnZhbCgkcmVxdWVzdCkpKTsgfSB9IH0gaWYgKGlzX251bGwoJHJlcXVlc3QpIHx8IGVtcHR5KCRyZXF1ZXN0KSkgeyAkc3RvcmluZyA9ICR0aGlzLT5zdG9yaW5nID8gJGZvcm0tPnNlc3Npb24oJ2dldCcsICR0aGlzLT5uYW1lKSA6IG51bGw7IGlmICgkdGhpcy0+c3RvcmluZyAmJiAoJGZvcm0tPnN0YXR1cyA9PSAnc3VibWl0JyAmJiAoISRmb3JtLT5zdGVwIHx8ICRmb3JtLT5zdGVwID09ICR0aGlzLT5zdGVwICYmICRmb3JtLT5zdGVwID09ICRmb3JtLT5zZXNzaW9uKCdnZXQnLCAnc3RlcCcpKSB8fCAoJGZvcm0tPnN0YXR1cyA9PSAnY2hlY2snICYmICRmb3JtLT5zb3VyY2UoJ3d3X19maWVsZCcpID09ICR0aGlzLT5uYW1lKSkpIHsgJHRoaXMtPnZhbHVlID0gbnVsbDsgJGZvcm0tPnNlc3Npb24oJ3JlbW92ZScsICR0aGlzLT5uYW1lKTsgfSBlbHNlIGlmICghaXNfbnVsbCgkc3RvcmluZykpIHsgJHRoaXMtPnZhbHVlID0gJHN0b3Jpbmc7IH0gfSBlbHNlIHsgJHRoaXMtPnZhbHVlID0gJHJlcXVlc3Q7IGlmICgkdGhpcy0+c3RvcmluZykgeyAkZm9ybS0+c2Vzc2lvbignc2V0JywgJHRoaXMtPm5hbWUsICR0aGlzLT52YWx1ZSk7IH0gfSB9IH0gfSByZXR1cm4gJHRoaXM7IH0gcHJvdGVjdGVkIGZ1bmN0aW9uIF9jaGVjaygkcnVsZSwgJHZhbHVlKSB7IGlmICgkdGhpcy0+dHlwZSA9PSAnZmlsZScpIHsgaWYgKCFlbXB0eSgkdmFsdWUpKSB7IHN3aXRjaCAoJHJ1bGVbJ3J1bGUnXSkgeyBjYXNlICdzaXplLW1pbic6IGNhc2UgJ3NpemUtbWF4JzogJHNpemUgPSAkdmFsdWVbJ3NpemUnXSAvIDEwMjQ7IGlmIChhcnJheV9rZXlfZXhpc3RzKCdzZXR0aW5nJywgJHJ1bGUpICYmIGlzX2ludCgkcnVsZVsnc2V0dGluZyddKSAmJiAoJHJ1bGVbJ3J1bGUnXSA9PSAnc2l6ZS1taW4nICYmICRzaXplIDwgJHJ1bGVbJ3NldHRpbmcnXSB8fCAkcnVsZVsncnVsZSddID09ICdzaXplLW1heCcgJiYgJHNpemUgPiAkcnVsZVsnc2V0dGluZyddKSkgeyByZXR1cm4gZmFsc2U7IH0gYnJlYWs7IGNhc2UgJ2Zvcm1hdHMnOiAkZm9ybWF0ID0gc3Vic3RyKHN0cnJjaHIobWJfc3RydG9sb3dlcigkdmFsdWVbJ25hbWUnXSksICcuJyksIDEpOyBpZiAoYXJyYXlfa2V5X2V4aXN0cygnc2V0dGluZycsICRydWxlKSAmJiBpc19hcnJheSgkcnVsZVsnc2V0dGluZyddKSAmJiAhZW1wdHkoJHJ1bGVbJ3NldHRpbmcnXSkgJiYgKCFpbl9hcnJheSgkZm9ybWF0LCAkcnVsZVsnc2V0dGluZyddKSAmJiAhaW5fYXJyYXkoJHZhbHVlWyd0eXBlJ10sICRydWxlWydzZXR0aW5nJ10pKSkgeyByZXR1cm4gZmFsc2U7IH0gfSB9IGVsc2UgaWYgKCRydWxlWydydWxlJ10gPT0gJ3JlcXVpcmVkJykgeyByZXR1cm4gZmFsc2U7IH0gfSBlbHNlIHsgJHZhbHVlID0gc3RydmFsKCR2YWx1ZSk7IHN3aXRjaCAoJHJ1bGVbJ3J1bGUnXSkgeyBjYXNlICdyZXF1aXJlZCc6IGlmIChlbXB0eSgkdGhpcy0+cm93cykgJiYgZW1wdHkoJHZhbHVlKSB8fCAhZW1wdHkoJHRoaXMtPnJvd3MpICYmICFhcnJheV9rZXlfZXhpc3RzKCR2YWx1ZSwgJHRoaXMtPnJvd3MpICYmICFpbl9hcnJheSgkdmFsdWUsICR0aGlzLT5yb3dzKSkgeyByZXR1cm4gZmFsc2U7IH0gYnJlYWs7IGNhc2UgJ2xlbmd0aC1taW4nOiBpZiAoYXJyYXlfa2V5X2V4aXN0cygnc2V0dGluZycsICRydWxlKSAmJiBpc19pbnQoJHJ1bGVbJ3NldHRpbmcnXSkgJiYgbWJfc3RybGVuKCR2YWx1ZSwgJ3V0Zi04JykgPCAkcnVsZVsnc2V0dGluZyddKSB7IHJldHVybiBmYWxzZTsgfSBicmVhazsgY2FzZSAnbGVuZ3RoLW1heCc6IGlmIChhcnJheV9rZXlfZXhpc3RzKCdzZXR0aW5nJywgJHJ1bGUpICYmIGlzX2ludCgkcnVsZVsnc2V0dGluZyddKSAmJiBtYl9zdHJsZW4oJHZhbHVlLCAndXRmLTgnKSA+ICRydWxlWydzZXR0aW5nJ10pIHsgcmV0dXJuIGZhbHNlOyB9IGJyZWFrOyBjYXNlICdwYXR0ZXJuJzogaWYgKGFycmF5X2tleV9leGlzdHMoJ3NldHRpbmcnLCAkcnVsZSkgJiYgaXNfc3RyaW5nKCRydWxlWydzZXR0aW5nJ10pICYmICFAcHJlZ19tYXRjaCgkcnVsZVsnc2V0dGluZyddLCAkdmFsdWUpKSB7IHJldHVybiBmYWxzZTsgfSBicmVhazsgZGVmYXVsdDogaWYgKGFycmF5X2tleV9leGlzdHMoJHJ1bGVbJ3J1bGUnXSwgJHRoaXMtPl9wYXR0ZXJucykpIHsgJGZpbHRlciA9ICR0aGlzLT5fcGF0dGVybnNbJHJ1bGVbJ3J1bGUnXV07IGlmIChkZWZpbmVkKCRmaWx0ZXIpKSB7IGlmICghZmlsdGVyX3ZhcigkdmFsdWUsIGV2YWwoJ3JldHVybiAnIC4gJGZpbHRlciAuICc7JykpKSB7IHJldHVybiBmYWxzZTsgfSB9IGVsc2UgaWYgKCFwcmVnX21hdGNoKCRmaWx0ZXIsICR2YWx1ZSkpIHsgcmV0dXJuIGZhbHNlOyB9IH0gfSB9IHJldHVybiB0cnVlOyB9IH0gY2xhc3MgV1dfRm9ybV9Hcm91cCBleHRlbmRzIFdXX0VudGl0eSB7IHB1YmxpYyAkYXR0cmlidXRlczsgcHVibGljICRhdHRyaWJ1dGVzQ29udGFpbmVyOyBwdWJsaWMgJGZpZWxkcyA9IGFycmF5KCk7IHB1YmxpYyAkbWFya3VwOyBwdWJsaWMgJG11bHRpcGxlOyBwdWJsaWMgJHN0ZXA7IHB1YmxpYyAkdGl0bGU7IHByb3RlY3RlZCAkX2VudGl0eSA9IGFycmF5KCk7IHByb3RlY3RlZCAkX3ByZXBhcmVkOyBwdWJsaWMgZnVuY3Rpb24gcHJlcGFyZShXV19Gb3JtICRmb3JtKSB7IGlmICghJHRoaXMtPl9wcmVwYXJlZCkgeyAkdGhpcy0+X3ByZXBhcmVkID0gdHJ1ZTsgaWYgKGlzX2FycmF5KCR0aGlzLT5tdWx0aXBsZSkpIHsgJHJvd3MgPSBhcnJheSgpOyBmb3IgKCRpID0gMDsgJGkgPCAoYXJyYXlfa2V5X2V4aXN0cygnbWluJywgJHRoaXMtPm11bHRpcGxlKSA/ICR0aGlzLT5tdWx0aXBsZVsnbWluJ10gOiAxKTsgJGkrKykgeyAkcm93c1tdID0gYXJyYXkoKTsgfSAkdGhpcy0+bXVsdGlwbGVbJ3Jvd3MnXSA9ICRmb3JtLT5zZXNzaW9uKCdnZXQnLCAkdGhpcy0+aWQsIGFycmF5X2tleV9leGlzdHMoJ3Jvd3MnLCAkdGhpcy0+bXVsdGlwbGUpID8gJHRoaXMtPm11bHRpcGxlWydyb3dzJ10gOiAkcm93cyk7IHN3aXRjaCAoJGZvcm0tPnN0YXR1cykgeyBjYXNlICdncm91cC1hZGQnOiBpZiAoJGZvcm0tPnNvdXJjZSgnd3dfX2dyb3VwJykgPT0gJHRoaXMtPmlkICYmICghYXJyYXlfa2V5X2V4aXN0cygnbWF4JywgJHRoaXMtPm11bHRpcGxlKSB8fCBjb3VudCgkdGhpcy0+bXVsdGlwbGVbJ3Jvd3MnXSkgPCAkdGhpcy0+bXVsdGlwbGVbJ21heCddKSkgeyAkdGhpcy0+bXVsdGlwbGVbJ3Jvd3MnXVtdID0gYXJyYXkoKTsgJGZvcm0tPmFqYXhbJ2luZGV4J10gPSBlbmQoYXJyYXlfa2V5cygkdGhpcy0+bXVsdGlwbGVbJ3Jvd3MnXSkpOyAkZm9ybS0+YWpheFsnc3VjY2VzcyddID0gdHJ1ZTsgfSBicmVhazsgY2FzZSAnZ3JvdXAtcmVtb3ZlJzogJGluZGV4ID0gJGZvcm0tPnNvdXJjZSgnd3dfX2dyb3VwX2luZGV4Jyk7IGlmICgkZm9ybS0+c291cmNlKCd3d19fZ3JvdXAnKSA9PSAkdGhpcy0+aWQgJiYgYXJyYXlfa2V5X2V4aXN0cygkaW5kZXgsICR0aGlzLT5tdWx0aXBsZVsncm93cyddKSAmJiAoIWFycmF5X2tleV9leGlzdHMoJ21pbicsICR0aGlzLT5tdWx0aXBsZSkgfHwgY291bnQoJHRoaXMtPm11bHRpcGxlWydyb3dzJ10pID4gJHRoaXMtPm11bHRpcGxlWydtaW4nXSkpIHsgdW5zZXQoJHRoaXMtPm11bHRpcGxlWydyb3dzJ11bJGluZGV4XSk7IGZvcmVhY2ggKCR0aGlzLT5fZW50aXR5IGFzICRlbnRpdHkpIHsgJGZvcm0tPnNlc3Npb24oJ3JlbW92ZScsICRlbnRpdHktPm5hbWUgLiAnLScgLiAkaW5kZXgpOyB9ICRmb3JtLT5hamF4WydzdWNjZXNzJ10gPSB0cnVlOyB9IGJyZWFrOyB9ICRmb3JtLT5zZXNzaW9uKCdzZXQnLCAkdGhpcy0+aWQsICR0aGlzLT5tdWx0aXBsZVsncm93cyddKTsgZm9yZWFjaCAoJHRoaXMtPm11bHRpcGxlWydyb3dzJ10gYXMgJGluZGV4ID0+ICRyb3cpIHsgZm9yZWFjaCAoJHRoaXMtPl9lbnRpdHkgYXMgJGVudGl0eSkgeyAkdGhpcy0+ZmllbGRzW10gPSAkY2xvbmUgPSBjbG9uZSAkZW50aXR5OyAkY2xvbmUtPmlkIC49ICctJyAuICRpbmRleDsgJGNsb25lLT5uYW1lIC49ICctJyAuICRpbmRleDsgaWYgKCFlbXB0eSgkcm93WyRlbnRpdHktPm5hbWVdKSkgeyBmb3JlYWNoICgkcm93WyRlbnRpdHktPm5hbWVdIGFzICRwcm9wZXJ0eSA9PiAkdmFsdWUpIHsgJGNsb25lLT57JHByb3BlcnR5fSA9ICR2YWx1ZTsgfSB9IH0gfSBpZiAoYXJyYXlfa2V5X2V4aXN0cygnaW5kZXgnLCAkZm9ybS0+YWpheCkpIHsgJGZvcm0tPmFqYXhbJ2h0bWwnXSA9ICR0aGlzLT5fZ2V0Um93KCRmb3JtLT5hamF4WydpbmRleCddKTsgfSB9IGVsc2UgeyAkdGhpcy0+ZmllbGRzID0gJHRoaXMtPl9lbnRpdHk7IH0gfSByZXR1cm4gJHRoaXM7IH0gcHVibGljIGZ1bmN0aW9uIGZpZWxkKCRmaWVsZCkgeyBpZiAoaXNfb2JqZWN0KCRmaWVsZCkgJiYgZ2V0X2NsYXNzKCRmaWVsZCkgPT0gJ1dXX0Zvcm1fRmllbGQnKSB7ICR0aGlzLT5fZW50aXR5W10gPSAkZmllbGQ7IH0gZWxzZSB7ICR0aGlzLT5fZW50aXR5W10gPSBXV19Gb3JtX0ZpZWxkOjpmYWN0b3J5KCRmaWVsZCk7IH0gcmV0dXJuICR0aGlzOyB9IHB1YmxpYyBmdW5jdGlvbiBmaWVsZHMoYXJyYXkgJGZpZWxkcykgeyBmb3JlYWNoICgkZmllbGRzIGFzICRwcm9wZXJ0aWVzKSB7ICR0aGlzLT5maWVsZCgkcHJvcGVydGllcyk7IH0gcmV0dXJuICR0aGlzOyB9IHB1YmxpYyBmdW5jdGlvbiBmaW5kKCRwcm9wZXJ0eSwgJHZhbHVlKSB7IGZvcmVhY2ggKCR0aGlzLT5maWVsZHMgYXMgJGZpZWxkKSB7IGlmICgkZmllbGQtPnskcHJvcGVydHl9ID09ICR2YWx1ZSkgeyByZXR1cm4gJGZpZWxkOyB9IH0gcmV0dXJuIG51bGw7IH0gcHVibGljIGZ1bmN0aW9uIGdldCgpIHsgaWYgKCR0aGlzLT5tYXJrdXApIHsgcmV0dXJuIHN0cnZhbCgkdGhpcy0+bWFya3VwKTsgfSBlbHNlIHsgJG1hcmt1cCA9ICR0aGlzLT50aXRsZSA/ICR0aGlzLT5odG1sKCdkaXYnLCBhcnJheSgnY2xhc3MnID0+ICd3d19fZ3JvdXBfdGl0bGUnKSwgJHRoaXMtPnRpdGxlKSA6ICcnOyAkYXR0cmlidXRlc0NvbnRhaW5lciA9IGlzX2FycmF5KCR0aGlzLT5hdHRyaWJ1dGVzQ29udGFpbmVyKSA/ICR0aGlzLT5hdHRyaWJ1dGVzQ29udGFpbmVyIDogYXJyYXkoKTsgJGF0dHJpYnV0ZXNDb250YWluZXJbJ2lkJ10gPSAkdGhpcy0+aWQ7ICRhdHRyaWJ1dGVzQ29udGFpbmVyWydjbGFzcyddID0gJ3d3X19ncm91cF9jb250YWluZXInOyBpZiAoJHRoaXMtPm11bHRpcGxlKSB7ICRhdHRyaWJ1dGVzQ29udGFpbmVyWyd3dy1tdWx0aXBsZSddID0gbnVsbDsgaWYgKGFycmF5X2tleV9leGlzdHMoJ21pbicsICR0aGlzLT5tdWx0aXBsZSkpIHsgJGF0dHJpYnV0ZXNDb250YWluZXJbJ3d3LW1pbiddID0gJHRoaXMtPm11bHRpcGxlWydtaW4nXTsgfSBpZiAoYXJyYXlfa2V5X2V4aXN0cygnbWF4JywgJHRoaXMtPm11bHRpcGxlKSkgeyAkYXR0cmlidXRlc0NvbnRhaW5lclsnd3ctbWF4J10gPSAkdGhpcy0+bXVsdGlwbGVbJ21heCddOyB9IGZvcmVhY2ggKCR0aGlzLT5tdWx0aXBsZVsncm93cyddIGFzICRpbmRleCA9PiAkcm93KSB7ICRtYXJrdXAgLj0gJHRoaXMtPl9nZXRSb3coJGluZGV4KTsgfSAkbWFya3VwIC49ICR0aGlzLT5odG1sKCdidXR0b24nLCBhcnJheSgnY2xhc3MnID0+ICd3d19fZ3JvdXBfYWRkJywgJ3d3LWdyb3VwJyA9PiAkdGhpcy0+aWQpLCAkdGhpcy0+bXVsdGlwbGVbJ2FkZCddKTsgfSBlbHNlIHsgJGF0dHJpYnV0ZXMgPSBpc19hcnJheSgkdGhpcy0+YXR0cmlidXRlcykgPyAkdGhpcy0+YXR0cmlidXRlcyA6IGFycmF5KCk7ICRhdHRyaWJ1dGVzWydpZCddID0gJHRoaXMtPmlkOyBmb3JlYWNoICgkdGhpcy0+ZmllbGRzIGFzICRmaWVsZCkgeyBpZiAoISRmaWVsZC0+c3RlcCB8fCAhJHRoaXMtPnN0ZXAgfHwgJGZpZWxkLT5zdGVwID09ICR0aGlzLT5zdGVwKSB7ICRtYXJrdXAgLj0gJGZpZWxkLT5nZXQoKTsgfSB9ICRtYXJrdXAgPSAkdGhpcy0+aHRtbCgnZmllbGRzZXQnLCAkYXR0cmlidXRlcywgJG1hcmt1cCk7IH0gcmV0dXJuICR0aGlzLT5odG1sKCdkaXYnLCAkYXR0cmlidXRlc0NvbnRhaW5lciwgJG1hcmt1cCk7IH0gfSBwcm90ZWN0ZWQgZnVuY3Rpb24gX2dldFJvdygkaW5kZXgpIHsgJG1hcmt1cCA9ICcnOyAkYXR0cmlidXRlcyA9IGlzX2FycmF5KCR0aGlzLT5hdHRyaWJ1dGVzKSA/ICR0aGlzLT5hdHRyaWJ1dGVzIDogYXJyYXkoKTsgJGF0dHJpYnV0ZXNbJ2lkJ10gLj0gJHRoaXMtPmlkIC4gJy0nIC4gJGluZGV4OyAkYXR0cmlidXRlc1snd3ctaW5kZXgnXSA9ICRpbmRleDsgZm9yZWFjaCAoJHRoaXMtPl9lbnRpdHkgYXMgJGVudGl0eSkgeyAkbWFya3VwIC49ICR0aGlzLT5maW5kKCdpZCcsICgkZW50aXR5LT5pZCAuICctJyAuICRpbmRleCkpLT5nZXQoKTsgfSAkbWFya3VwIC49ICR0aGlzLT5odG1sKCdidXR0b24nLCBhcnJheSgnY2xhc3MnID0+ICd3d19fZ3JvdXBfcmVtb3ZlJywgJ3d3LWdyb3VwJyA9PiAkdGhpcy0+aWQsICd3dy1pbmRleCcgPT4gJGluZGV4LCAndGl0bGUnID0+ICR0aGlzLT5tdWx0aXBsZVsncmVtb3ZlJ10pLCAn4pyVJyk7IHJldHVybiAkdGhpcy0+aHRtbCgnZmllbGRzZXQnLCAkYXR0cmlidXRlcywgJG1hcmt1cCk7IH0gfQ=='));